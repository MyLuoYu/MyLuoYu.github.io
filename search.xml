<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Linuxå¸¸ç”¨å‘½ä»¤</title>
    <url>/Linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
    <content><![CDATA[<p>Â Â Â Â æœ¬æ–‡æ’°å†™çš„ç›®çš„æ˜¯ä¸ºäº†ä½¿åˆšæ¥è§¦Linuxçš„å°ç™½æ›´å¥½çš„æ“ä½œä½¿ç”¨Linuxï¼Œä»¥åŠä½œä¸ºä¸ªäººçš„å¤‡å¿˜å½•ã€‚æ–‡ç« ä»‹ç»çš„å‘½ä»¤æ˜¯æœ¬åœ¨Linuxç³»ç»Ÿæ—¥å¸¸ä½¿ç”¨ä¸­å¸¸ç”¨åˆ°çš„ï¼Œæˆ–è€…æ˜¯åœ¨æœåŠ¡å™¨ä¸Šå¼€å‘æ‰€ç”¨åˆ°çš„é«˜é¢‘ç‡å‘½ä»¤ã€‚</p>
<p>Â Â Â Â ç‚¹å‡»ä¸‹è½½ğŸ‘‰<a href="">PDFä¸‹è½½</a></p>
<span id="more"></span>

<h1 id="åˆ‡æ¢ç›®å½•ï¼šcd"><a href="#åˆ‡æ¢ç›®å½•ï¼šcd" class="headerlink" title="åˆ‡æ¢ç›®å½•ï¼šcd"></a>åˆ‡æ¢ç›®å½•ï¼šcd</h1><h2 id="cdå‘½ä»¤æ ¼å¼"><a href="#cdå‘½ä»¤æ ¼å¼" class="headerlink" title="cdå‘½ä»¤æ ¼å¼"></a>cdå‘½ä»¤æ ¼å¼</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> [ç›®å½•è·¯å¾„]</span><br></pre></td></tr></table></figure>

<h2 id="æ‹“å±•"><a href="#æ‹“å±•" class="headerlink" title="æ‹“å±•"></a>æ‹“å±•</h2><p><strong>[ç›®å½•è·¯å¾„]</strong> å¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ä¹Ÿå¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œå¸¸è§çš„ç›¸å¯¹è·¯å¾„æœ‰ï¼š</p>
<ul>
<li><p>.&#x2F;Â Â Â Â è¡¨ç¤ºå½“å‰ç›®å½•</p>
</li>
<li><p>..&#x2F;   è¡¨ç¤ºä¸Šä¸€çº§ç›®å½•</p>
</li>
<li><p>~    è¡¨ç¤ºç”¨æˆ·ä¸»ç›®å½•ï¼ˆ&#x2F;home&#x2F;userï¼‰</p>
</li>
<li><p>-Â Â Â Â è¡¨ç¤ºä¸Šä¸€æ¬¡å·¥ä½œè·¯å¾„</p>
</li>
</ul>
<h2 id="æ¡ˆä¾‹"><a href="#æ¡ˆä¾‹" class="headerlink" title="æ¡ˆä¾‹"></a>æ¡ˆä¾‹</h2><p>è¿›å…¥æ ¹ç›®å½•</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /</span><br></pre></td></tr></table></figure>

<p>è¿›å…¥ â€œhomeâ€ ç›®å½•</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~</span><br><span class="line"><span class="built_in">cd</span></span><br></pre></td></tr></table></figure>

<p>è¿›å…¥ä¸Šä¸€æ¬¡å·¥ä½œè·¯å¾„</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> -</span><br></pre></td></tr></table></figure>

<p>è¿›å…¥ä¸Šä¸€çº§ç›®å½•</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> ../</span><br></pre></td></tr></table></figure>

<h1 id="æŸ¥è¯¢å½“å‰ç›®å½•è·¯å¾„ï¼špwd"><a href="#æŸ¥è¯¢å½“å‰ç›®å½•è·¯å¾„ï¼špwd" class="headerlink" title="æŸ¥è¯¢å½“å‰ç›®å½•è·¯å¾„ï¼špwd"></a>æŸ¥è¯¢å½“å‰ç›®å½•è·¯å¾„ï¼špwd</h1><blockquote>
<p>è¿™æ˜¯ä¸€ä¸ªç›¸å½“å¸¸ç”¨çš„å‘½ä»¤ï¼Œä¸€èˆ¬åœ¨å†™é…ç½®æ–‡ä»¶æ—¶å¸¸å¸¸è¦æŒ‡å®šä¸€ä¸ªç›®å½•æˆ–è€…æ–‡ä»¶ã€‚<br>æ‰€ä»¥ï¼Œä¼šåœ¨å†™æ–‡ä»¶æ—¶å€™æå‰wpdæ˜¾ç¤ºç›®å½•è·¯å¾„è¿›è¡Œå¤åˆ¶ã€‚</p>
</blockquote>
<h2 id="å‘½ä»¤æ ¼å¼"><a href="#å‘½ä»¤æ ¼å¼" class="headerlink" title="å‘½ä»¤æ ¼å¼"></a>å‘½ä»¤æ ¼å¼</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">pwd</span></span><br></pre></td></tr></table></figure>

<h2 id="æ‹“å±•-1"><a href="#æ‹“å±•-1" class="headerlink" title="æ‹“å±•"></a>æ‹“å±•</h2><p>åœ¨<em>ç»ˆç«¯</em>ä¸­çš„<u><strong>å¤åˆ¶</strong></u>å¿«æ·é”®æ˜¯ï¼šCtrl + Shift + C<br>åœ¨<em>ç»ˆç«¯</em>ä¸­çš„<strong>ç²˜è´´</strong>å¿«æ·é”®æ˜¯ï¼šCtrl + Shift + V</p>
<h1 id="æŸ¥è¯¢æ–‡ä»¶å‘½ä»¤ï¼šls"><a href="#æŸ¥è¯¢æ–‡ä»¶å‘½ä»¤ï¼šls" class="headerlink" title="æŸ¥è¯¢æ–‡ä»¶å‘½ä»¤ï¼šls"></a>æŸ¥è¯¢æ–‡ä»¶å‘½ä»¤ï¼šls</h1><h2 id="å‘½ä»¤æ ¼å¼-1"><a href="#å‘½ä»¤æ ¼å¼-1" class="headerlink" title="å‘½ä»¤æ ¼å¼"></a>å‘½ä»¤æ ¼å¼</h2><p>ä¸åŠ  <strong>[ç›®å½•è·¯å¾„]</strong> é»˜è®¤ä¸ºå½“å‰ç›®å½•</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">ls</span> [ç›®å½•è·¯å¾„]</span><br></pre></td></tr></table></figure>

<h2 id="å‚æ•°"><a href="#å‚æ•°" class="headerlink" title="å‚æ•°"></a>å‚æ•°</h2><ul>
<li><strong>-l</strong>ï¼šé™¤äº†æ–‡ä»¶åä¹‹å¤–ï¼Œè¿˜å°†æ–‡ä»¶çš„æƒé™ã€æ‰€æœ‰è€…ã€æ–‡ä»¶å¤§å°ç­‰ä¿¡æ¯è¯¦ç»†åˆ—å‡ºæ¥</li>
<li><strong>-a</strong>ï¼šæ˜¾ç¤ºæ‰€æœ‰ç›®å½•å’Œæ–‡ä»¶ï¼ˆåŒ…æ‹¬éšè—ç›®å½•ï¼‰</li>
<li><strong>-A</strong>ï¼šåˆ—å‡ºé™¤.åŠ..çš„å…¶å®ƒæ–‡ä»¶</li>
<li><strong>-r</strong>ï¼šååºæ’åˆ—</li>
<li><strong>-S</strong>ï¼šä»¥æ–‡ä»¶å¤§å°æ’åº</li>
</ul>
<h2 id="æ¡ˆä¾‹-1"><a href="#æ¡ˆä¾‹-1" class="headerlink" title="æ¡ˆä¾‹"></a>æ¡ˆä¾‹</h2><p>æŒ‰å¤§å°ååºæ˜¾ç¤ºæ–‡ä»¶è¯¦ç»†ä¿¡æ¯</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">ls</span> -lrS</span><br></pre></td></tr></table></figure>

<p>æŒ‰ä¿®æ”¹æ—¶é—´ååºæ’åºï¼Œå¹¶æ˜¾ç¤ºæ–‡ä»¶è¯¦ç»†ä¿¡æ¯</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">ls</span> -lrt</span><br></pre></td></tr></table></figure>

<p>åˆ—å‡ºå½“å‰ç›®å½•ä¸­æ‰€æœ‰ä»¥â€tâ€å¼€å¤´çš„ç›®å½•çš„è¯¦ç»†å†…å®¹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">ls</span> -l t*</span><br></pre></td></tr></table></figure>

<p>åˆ—å‡ºæ–‡ä»¶ç»å¯¹è·¯å¾„ï¼ˆä¸åŒ…å«éšè—æ–‡ä»¶ï¼‰</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">ls</span> | sed <span class="string">&quot;s:^:`pwd`/:&quot;</span></span><br></pre></td></tr></table></figure>

<h1 id="åˆ›å»ºç›®å½•-æ–‡ä»¶å¤¹-ï¼šmkdir"><a href="#åˆ›å»ºç›®å½•-æ–‡ä»¶å¤¹-ï¼šmkdir" class="headerlink" title="åˆ›å»ºç›®å½•(æ–‡ä»¶å¤¹)ï¼šmkdir"></a>åˆ›å»ºç›®å½•(æ–‡ä»¶å¤¹)ï¼šmkdir</h1><h2 id="å‘½ä»¤æ ¼å¼-2"><a href="#å‘½ä»¤æ ¼å¼-2" class="headerlink" title="å‘½ä»¤æ ¼å¼"></a>å‘½ä»¤æ ¼å¼</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> [å‚æ•°] [ç›®å½•å]</span><br></pre></td></tr></table></figure>

<h2 id="å‚æ•°-1"><a href="#å‚æ•°-1" class="headerlink" title="å‚æ•°"></a>å‚æ•°</h2><ul>
<li><strong>-m</strong>  Â ï¼šå¯¹æ–°å»ºç›®å½•è®¾ç½®å­˜å–æƒé™ï¼Œä¹Ÿå¯ä»¥ç”¨ chmod å‘½ä»¤è®¾ç½®</li>
<li><strong>-p</strong>    ï¼šå¯ä»¥æ˜¯ä¸€ä¸ªè·¯å¾„åç§°ã€‚æ­¤æ—¶è‹¥è·¯å¾„ä¸­çš„æŸäº›ç›®å½•å°šä¸å­˜åœ¨,åŠ ä¸Šæ­¤é€‰é¡¹åï¼Œç³»ç»Ÿå°†è‡ªåŠ¨å»ºç«‹å¥½é‚£äº›å°šä¸åœ¨çš„ç›®å½•ï¼Œå³ä¸€æ¬¡å¯ä»¥å»ºç«‹å¤šä¸ªç›®å½•ã€‚</li>
</ul>
<h2 id="æ¡ˆä¾‹-2"><a href="#æ¡ˆä¾‹-2" class="headerlink" title="æ¡ˆä¾‹"></a>æ¡ˆä¾‹</h2><p>å½“å‰å·¥ä½œç›®å½•ä¸‹åˆ›å»ºåä¸º tçš„æ–‡ä»¶å¤¹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> t</span><br></pre></td></tr></table></figure>

<p>åœ¨ tmp ç›®å½•ä¸‹åˆ›å»ºè·¯å¾„ä¸º test&#x2F;t1&#x2F;t çš„ç›®å½•ï¼Œè‹¥ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»º</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /tmp/test/t1/t</span><br></pre></td></tr></table></figure>

<h1 id="åˆ é™¤å‘½ä»¤ï¼šrm"><a href="#åˆ é™¤å‘½ä»¤ï¼šrm" class="headerlink" title="åˆ é™¤å‘½ä»¤ï¼šrm"></a>åˆ é™¤å‘½ä»¤ï¼šrm</h1><h2 id="å‘½ä»¤æ ¼å¼-3"><a href="#å‘½ä»¤æ ¼å¼-3" class="headerlink" title="å‘½ä»¤æ ¼å¼"></a>å‘½ä»¤æ ¼å¼</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">rm</span> [é€‰é¡¹] æ–‡ä»¶(ç›®å½•)â€¦</span><br></pre></td></tr></table></figure>

<h2 id="å‚æ•°-2"><a href="#å‚æ•°-2" class="headerlink" title="å‚æ•°"></a>å‚æ•°</h2><ul>
<li><p><strong>-r</strong>Â Â Â Â ï¼šåˆ é™¤ä¸€ä¸ªç›®å½•ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶æˆ–ç›®å½•ï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨ -r é€‰é¡¹ï¼Œåˆ™ rm ä¸ä¼šåˆ é™¤ç›®</p>
</li>
<li><p><strong>-i</strong>    ï¼šåˆ é™¤ä»»ä½•æ–‡ä»¶ï¼Œåˆ é™¤å‰é€ä¸€è¯¢é—®ç¡®è®¤</p>
</li>
<li><p><strong>-rf</strong>    ï¼šåˆ é™¤å­ç›®å½•åŠå­ç›®å½•ä¸­æ‰€æœ‰æ¡£æ¡ˆåˆ é™¤ï¼Œå¹¶ä¸”ä¸ç”¨ç¡®è®¤</p>
</li>
</ul>
<h2 id="æ¡ˆä¾‹-3"><a href="#æ¡ˆä¾‹-3" class="headerlink" title="æ¡ˆä¾‹"></a>æ¡ˆä¾‹</h2><p>åˆ é™¤ä»»ä½• .logç»“å°¾çš„æ–‡ä»¶ï¼Œåˆ é™¤å‰é€ä¸€è¯¢é—®ç¡®è®¤</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">rm</span> -i *.<span class="built_in">log</span></span><br></pre></td></tr></table></figure>

<p>åˆ é™¤ test å­ç›®å½•åŠå­ç›®å½•ä¸­æ‰€æœ‰æ¡£æ¡ˆåˆ é™¤ï¼Œå¹¶ä¸”ä¸ç”¨ä¸€ä¸€ç¡®è®¤ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">rm</span> -rf <span class="built_in">test</span></span><br></pre></td></tr></table></figure>

<p>åˆ é™¤ä»¥ -f å¼€å¤´çš„æ–‡ä»¶</p>
<blockquote>
<p>æ–‡ä»¶ï¼ˆç›®å½•ï¼‰ä»¥Â â€œ-â€å¼€å¤´ä¼šè®©å‘½ä»¤è¯¯è®¤ä¸ºæ˜¯å‚æ•°ï¼Œæ‰€ä»¥åŠ ä¸Šâ€œâ€“â€œè¿›è¡Œåˆ†éš”</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">rm</span> -- -f*</span><br></pre></td></tr></table></figure>

<h1 id="ç§»åŠ¨-é‡å‘½å-ï¼šmv"><a href="#ç§»åŠ¨-é‡å‘½å-ï¼šmv" class="headerlink" title="ç§»åŠ¨(é‡å‘½å)ï¼šmv"></a>ç§»åŠ¨(é‡å‘½å)ï¼šmv</h1><blockquote>
<p>ç§»åŠ¨æ–‡ä»¶æˆ–ä¿®æ”¹æ–‡ä»¶åï¼Œæ ¹æ®ç¬¬äºŒå‚æ•°ç±»å‹ï¼ˆå¦‚ç›®å½•ï¼Œåˆ™ç§»åŠ¨æ–‡ä»¶ï¼›å¦‚ä¸ºæ–‡ä»¶åˆ™é‡å‘½ä»¤è¯¥æ–‡ä»¶ï¼‰ã€‚</p>
<p>å½“ç¬¬äºŒä¸ªå‚æ•°ä¸ºç›®å½•æ—¶ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥æ˜¯å¤šä¸ªä»¥ç©ºæ ¼åˆ†éš”çš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œç„¶åç§»åŠ¨ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šçš„å¤šä¸ªæ–‡ä»¶åˆ°ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šçš„ç›®å½•ä¸­ã€‚</p>
</blockquote>
<h2 id="å‘½ä»¤æ ¼å¼-4"><a href="#å‘½ä»¤æ ¼å¼-4" class="headerlink" title="å‘½ä»¤æ ¼å¼"></a>å‘½ä»¤æ ¼å¼</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mv</span> [æ–‡ä»¶(ç›®å½•)] [æ–‡ä»¶(ç›®å½•)]</span><br></pre></td></tr></table></figure>

<h2 id="å‚æ•°-3"><a href="#å‚æ•°-3" class="headerlink" title="å‚æ•°"></a>å‚æ•°</h2><ul>
<li><strong>-i</strong>Â Â Â Â :æ˜¯å¦è¯¢é—®è¦†ç›–</li>
</ul>
<h2 id="æ¡ˆä¾‹-4"><a href="#æ¡ˆä¾‹-4" class="headerlink" title="æ¡ˆä¾‹"></a>æ¡ˆä¾‹</h2><p>å°†æ–‡ä»¶ test.log é‡å‘½åä¸º test1.txt</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mv</span> test.log test1.txt</span><br></pre></td></tr></table></figure>

<p>å°†æ–‡ä»¶ log1.txt,log2.txt,log3.txt ç§»åŠ¨åˆ°æ ¹çš„ test3 ç›®å½•ä¸­</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mv</span> llog1.txt log2.txt log3.txt /test3</span><br></pre></td></tr></table></figure>

<p>å°†æ–‡ä»¶ file1 æ”¹åä¸º file2ï¼Œå¦‚æœ file2 å·²ç»å­˜åœ¨ï¼Œåˆ™è¯¢é—®æ˜¯å¦è¦†ç›–</p>
<blockquote>
<p>ä¸åŠ å‚æ•°-iåˆ™å¼ºåˆ¶è¦†ç›–</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mv</span> -i log1.txt log2.txt</span><br></pre></td></tr></table></figure>

<p>ç§»åŠ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åˆ°ä¸Šä¸€çº§ç›®å½•</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mv</span> * ../</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>ITçŸ¥è¯†</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>Manjaro-i3wmå®‰è£…</title>
    <url>/Manjaro-i3wm%E5%AE%89%E8%A3%85/</url>
    <content><![CDATA[<p>Â Â Â Â è¯¦ç»†ä»‹ç»Manjaroç³»ç»Ÿçš„i3wmæ¡Œé¢ç¯å¢ƒçš„å®‰è£…ä¸è¸©å‘ã€‚</p>
<p>Â Â Â Â ç‚¹å‡»ä¸‹è½½ğŸ‘‰<a href="">PDFä¸‹è½½</a></p>
<span id="more"></span>

<h1 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h1><p>manjaro i3å…¶å®æ˜¯i3-gaps,i3wmçš„åŠ å¼ºç‰ˆ,ä¸»è¦èƒ½ä½¿çª—å£é—´æœ‰é—´éš”ï¼è€Œä¸”ä¸‹è½½å®Œæ•´ç‰ˆå®‰è£…å¾ˆå¤šè½¯ä»¶åŠé…ç½®ï¼Œå¿«æ·é”®éƒ½é»˜è®¤è®¾ç½®å¥½äº†  ã€‚<br>ç³»ç»Ÿé•œåƒåœ¨å®˜ç½‘ä¸‹è½½çš„ç¤¾åŒºç‰ˆæœ¬manjaro+i3</p>
<h2 id="ISOé•œåƒä¸‹è½½"><a href="#ISOé•œåƒä¸‹è½½" class="headerlink" title="ISOé•œåƒä¸‹è½½"></a>ISOé•œåƒä¸‹è½½</h2><p><a href="https://manjaro.org/download/">ä¸‹è½½ç½‘å€</a>ï¼š<a href="https://manjaro.org/download/">https://manjaro.org/download/</a></p>
<p><img src="/Manjaro-i3wm%E5%AE%89%E8%A3%85/2022-08-13-21-01-55-image.png"></p>
<h2 id="åˆ»å½•Uç›˜"><a href="#åˆ»å½•Uç›˜" class="headerlink" title="åˆ»å½•Uç›˜"></a>åˆ»å½•Uç›˜</h2><h3 id="ä¸‹è½½Uç›˜åˆ»å½•å·¥å…·Rufus"><a href="#ä¸‹è½½Uç›˜åˆ»å½•å·¥å…·Rufus" class="headerlink" title="ä¸‹è½½Uç›˜åˆ»å½•å·¥å…·Rufus"></a>ä¸‹è½½Uç›˜åˆ»å½•å·¥å…·Rufus</h3><p><a href="https://rufus.en.softonic.com/">ä¸‹è½½åœ°å€</a>ï¼š<a href="https://rufus.en.softonic.com/">https://rufus.en.softonic.com/</a></p>
<h3 id="Rufusä½¿ç”¨"><a href="#Rufusä½¿ç”¨" class="headerlink" title="Rufusä½¿ç”¨"></a>Rufusä½¿ç”¨</h3><h2 id="è¿›å…¥BIOSå¯åŠ¨å®‰è£…ç¨‹åº"><a href="#è¿›å…¥BIOSå¯åŠ¨å®‰è£…ç¨‹åº" class="headerlink" title="è¿›å…¥BIOSå¯åŠ¨å®‰è£…ç¨‹åº"></a>è¿›å…¥BIOSå¯åŠ¨å®‰è£…ç¨‹åº</h2><h2 id="å®‰è£…Manjaro"><a href="#å®‰è£…Manjaro" class="headerlink" title="å®‰è£…Manjaro"></a>å®‰è£…Manjaro</h2>]]></content>
      <categories>
        <category>ITçŸ¥è¯†</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>Hadoopæ­å»ºè°ƒä¼˜ç¬”è®°</title>
    <url>/Hadoop%E6%90%AD%E5%BB%BA%E8%B0%83%E4%BC%98%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<p>Â Â Â Â ä½¿ç”¨Linuxï¼ˆmanjaroï¼‰ç³»ç»Ÿï¼Œä»è™šæ‹Ÿæœºå¼€å§‹æ­å»ºHadoopå¹³å°ä»¥åŠHadoopçš„è°ƒä¼˜ã€‚å†…å®¹ç®€å•è¯¦ç»†</p>
<p>Â Â Â Â ç‚¹å‡»ä¸‹è½½ğŸ‘‰<a href="">PDFä¸‹è½½</a></p>
<span id="more"></span>

<h2 id="Hadoopç¯å¢ƒæ­å»º"><a href="#Hadoopç¯å¢ƒæ­å»º" class="headerlink" title="Hadoopç¯å¢ƒæ­å»º"></a>Hadoopç¯å¢ƒæ­å»º</h2><h3 id="å‡†å¤‡æ¨¡æ¿æœº"><a href="#å‡†å¤‡æ¨¡æ¿æœº" class="headerlink" title="å‡†å¤‡æ¨¡æ¿æœº"></a>å‡†å¤‡æ¨¡æ¿æœº</h3><blockquote>
<p>é€‰æ‹©ç³»ç»Ÿï¼šCentosæœ€å°åŒ–æ¢å®‰è£…</p>
<p>ä»¥ä¸‹æ“ä½œå‡å¤„äºuserï¼ˆluoï¼‰ç”¨æˆ·ä¸‹è¿›è¡Œï¼Œæ“ä½œå¿…é¡»ä¿æŒæ“ä½œç”¨æˆ·ç»Ÿä¸€ã€‚</p>
</blockquote>
<h4 id="userï¼ˆluoï¼‰ç”¨æˆ·æƒé™è®¾ç½®"><a href="#userï¼ˆluoï¼‰ç”¨æˆ·æƒé™è®¾ç½®" class="headerlink" title="userï¼ˆluoï¼‰ç”¨æˆ·æƒé™è®¾ç½®"></a>userï¼ˆluoï¼‰ç”¨æˆ·æƒé™è®¾ç½®</h4><blockquote>
<p>é…ç½®luoç”¨æˆ·å…·æœ‰rootæƒé™ï¼Œæ–¹ä¾¿åæœŸåŠ sudoæ‰§è¡Œrootæƒé™çš„å‘½ä»¤</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim /etc/sudoers</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¿®æ”¹&#x2F;etc&#x2F;sudoersæ–‡ä»¶ï¼Œåœ¨%wheelè¿™è¡Œä¸‹é¢æ·»åŠ ä¸€è¡Œï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">## Allow root to run any commands anywhere</span></span><br><span class="line">root    ALL=(ALL)     ALL</span><br><span class="line"></span><br><span class="line"><span class="comment">## Allows people in group wheel to run all commands</span></span><br><span class="line">%wheel  ALL=(ALL)       ALL</span><br><span class="line">luo   ALL=(ALL)     NOPASSWD:ALL</span><br></pre></td></tr></table></figure>

<h4 id="ä¸‹è½½vimã€net-toolsã€rsync"><a href="#ä¸‹è½½vimã€net-toolsã€rsync" class="headerlink" title="ä¸‹è½½vimã€net-toolsã€rsync"></a>ä¸‹è½½vimã€net-toolsã€rsync</h4><blockquote>
<p>vimç”¨äºç¼–å†™æ–‡ä»¶</p>
<p>rsyncç”¨äºä¼ è¾“æ–‡ä»¶</p>
<p>net-toolsç”¨äºæŸ¥çœ‹ç½‘ç»œ</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo yum install net-tools.x86_64 </span><br><span class="line">sudo yum install rsync </span><br><span class="line">sudo yum install vim</span><br></pre></td></tr></table></figure>

<h4 id="é…ç½®é™æ€ç½‘ç»œ"><a href="#é…ç½®é™æ€ç½‘ç»œ" class="headerlink" title="é…ç½®é™æ€ç½‘ç»œ"></a>é…ç½®é™æ€ç½‘ç»œ</h4><blockquote>
<p>ç³»ç»Ÿç‰ˆæœ¬ä¸åŒifcfg-eth0æ–‡ä»¶å¯èƒ½å­˜åœ¨ä¸ä¸€è‡´</p>
<p>å¦‚ifcfg-ens33ç­‰ï¼Œä½†æ–‡ä»¶å†…å®¹ç›¸åŒ</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim /etc/sysconfig/network-scripts/ifcfg-eth0 </span><br></pre></td></tr></table></figure>

<blockquote>
<p>BOOTPROTO&#x3D;â€staticâ€    ç½‘ç»œè®¾ç½®ä¸ºé™æ€</p>
<p>IPADDR&#x3D;192.168.122.100    ipè®¾ç½®    ç½‘æ®µå¿…éœ€ä¸€è‡´ï¼ˆå½“å‰ç½‘æ®µä¸º122ï¼‰<br>GATEWAY&#x3D;192.168.122.1    ç½‘å…³è®¾ç½®<br>DNS1&#x3D;192.168.122.1    DNSè®¾ç½®</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">TYPE=<span class="string">&quot;Ethernet&quot;</span></span><br><span class="line">PROXY_METHOD=<span class="string">&quot;none&quot;</span></span><br><span class="line">BROWSER_ONLY=<span class="string">&quot;no&quot;</span></span><br><span class="line">BOOTPROTO=<span class="string">&quot;static&quot;</span></span><br><span class="line">DEFROUTE=<span class="string">&quot;yes&quot;</span></span><br><span class="line">IPV4_FAILURE_FATAL=<span class="string">&quot;no&quot;</span></span><br><span class="line">IPV6INIT=<span class="string">&quot;yes&quot;</span></span><br><span class="line">IPV6_AUTOCONF=<span class="string">&quot;yes&quot;</span></span><br><span class="line">IPV6_DEFROUTE=<span class="string">&quot;yes&quot;</span></span><br><span class="line">IPV6_FAILURE_FATAL=<span class="string">&quot;no&quot;</span></span><br><span class="line">IPV6_ADDR_GEN_MODE=<span class="string">&quot;stable-privacy&quot;</span></span><br><span class="line">NAME=<span class="string">&quot;eth0&quot;</span></span><br><span class="line">UUID=<span class="string">&quot;0980c27a-83b0-40da-a492-e1ea5164aa1c&quot;</span></span><br><span class="line">DEVICE=<span class="string">&quot;eth0&quot;</span></span><br><span class="line">ONBOOT=<span class="string">&quot;yes&quot;</span></span><br><span class="line"></span><br><span class="line">IPADDR=192.168.122.100</span><br><span class="line">GATEWAY=192.168.122.1</span><br><span class="line">DNS1=192.168.122.1</span><br></pre></td></tr></table></figure>

<blockquote>
<p>é‡å¯IPç½‘ç»œ</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo service network restart</span><br></pre></td></tr></table></figure>

<h4 id="é…ç½®æ˜ å°„å’Œä¸»æœºå"><a href="#é…ç½®æ˜ å°„å’Œä¸»æœºå" class="headerlink" title="é…ç½®æ˜ å°„å’Œä¸»æœºå"></a>é…ç½®æ˜ å°„å’Œä¸»æœºå</h4><blockquote>
<p>è¿›å…¥hostsæ–‡ä»¶ç¼–è¾‘</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim /etc/hosts</span><br></pre></td></tr></table></figure>

<blockquote>
<p>åœ¨æ–‡æ¡£ä¸­æ·»åŠ ï¼Œå°†æ¥è¦åŠ å…¥é›†ç¾¤çš„ipåŠå…¶åç§°</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line"></span><br><span class="line">192.168.122.100 hadoop100</span><br><span class="line">192.168.122.102 hadoop102</span><br><span class="line">192.168.122.103 hadoop103</span><br><span class="line">192.168.122.104 hadoop104</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¿›å…¥hostnameæ–‡ä»¶ç¼–è¾‘</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim /etc/hostname</span><br></pre></td></tr></table></figure>

<blockquote>
<p>åˆ é™¤åŸå…ˆä¸»æœºåç§°</p>
<p>ä¿®æ”¹ä¸ºè‡ªå®šä¹‰ä¸»æœºåç§°</p>
<p>æœ¬æœºä¸ºhadoop100</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hadoop100</span><br></pre></td></tr></table></figure>

<h4 id="å…³é—­é˜²ç«å¢™å’Œå¼€æœºè‡ªå¯"><a href="#å…³é—­é˜²ç«å¢™å’Œå¼€æœºè‡ªå¯" class="headerlink" title="å…³é—­é˜²ç«å¢™å’Œå¼€æœºè‡ªå¯"></a>å…³é—­é˜²ç«å¢™å’Œå¼€æœºè‡ªå¯</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">systemctl stop firewalld</span><br><span class="line">systemctl <span class="built_in">disable</span> firewalld.service</span><br></pre></td></tr></table></figure>

<h4 id="åˆ›å»ºç›®å½•å¹¶ä¿®æ”¹ç›®å½•æ‰€æœ‰è€…"><a href="#åˆ›å»ºç›®å½•å¹¶ä¿®æ”¹ç›®å½•æ‰€æœ‰è€…" class="headerlink" title="åˆ›å»ºç›®å½•å¹¶ä¿®æ”¹ç›®å½•æ‰€æœ‰è€…"></a>åˆ›å»ºç›®å½•å¹¶ä¿®æ”¹ç›®å½•æ‰€æœ‰è€…</h4><blockquote>
<p>åˆ›å»ºç›®å½•</p>
<p>moduleï¼šå­˜æ”¾è½¯ä»¶</p>
<p>softwareï¼šå­˜æ”¾è½¯ä»¶åŒ…</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo <span class="built_in">mkdir</span> /opt/module/ /opt/software/</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¿®æ”¹ç›®å½•æ‰€æœ‰è€…</p>
<p>å½“å‰ç”¨æˆ·ä¸ºluo</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo <span class="built_in">chown</span> luo:luo /opt/module/ /opt/software/</span><br></pre></td></tr></table></figure>

<h4 id="å®‰è£…jdkå’ŒhadoopåŠå…¶ç¯å¢ƒé…ç½®"><a href="#å®‰è£…jdkå’ŒhadoopåŠå…¶ç¯å¢ƒé…ç½®" class="headerlink" title="å®‰è£…jdkå’ŒhadoopåŠå…¶ç¯å¢ƒé…ç½®"></a>å®‰è£…jdkå’ŒhadoopåŠå…¶ç¯å¢ƒé…ç½®</h4><blockquote>
<p>åˆ›å»ºé…ç½®æ–‡ä»¶</p>
<p>ç³»ç»Ÿä¸­çš„profileé…ç½®æ–‡ä»¶ä¼šéå†profile.dä¸‹çš„æ‰€æœ‰.shæ–‡ä»¶</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim /etc/profile.d/my_env.sh</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ç¼–å†™é…ç½®æ–‡ä»¶</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#JAVA_HOME</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/opt/module/jdk-11</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$JAVA_HOME</span>/bin</span><br><span class="line"></span><br><span class="line"><span class="comment">#HADOOP_HOME</span></span><br><span class="line"><span class="built_in">export</span> HADOOP_HOME=/opt/module/hadoop-3.3.1</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HADOOP_HOME</span>/bin</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HADOOP_HOME</span>/sbin</span><br></pre></td></tr></table></figure>

<h3 id="å…å¯†ç™»å½•"><a href="#å…å¯†ç™»å½•" class="headerlink" title="å…å¯†ç™»å½•"></a>å…å¯†ç™»å½•</h3><blockquote>
<p>ç¯å¢ƒï¼š</p>
<ol>
<li>3å°ç”±hadoop100å…‹éš†çš„è™šæ‹Ÿæœº</li>
<li>é…ç½®3å°è™šæ‹Ÿæœºçš„é™æ€ç½‘ç»œå’Œä¸»æœºåï¼ˆ102ã€103ã€104ï¼‰</li>
<li>æ¥ä¸‹æ¥çš„æ“ä½œä»¥hadoop102ä¸ºä¸»æœº</li>
<li>hadoopxxxæ˜¯hostsçš„æ˜ å°„ip</li>
</ol>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh-keygen -t rsa</span><br><span class="line">ssh-copy-id hadoop102</span><br><span class="line">ssh-copy-id hadoop103</span><br><span class="line">ssh-copy-id hadoop104</span><br></pre></td></tr></table></figure>

<h3 id="Hadoopé›†ç¾¤é…ç½®"><a href="#Hadoopé›†ç¾¤é…ç½®" class="headerlink" title="Hadoopé›†ç¾¤é…ç½®"></a>Hadoopé›†ç¾¤é…ç½®</h3><blockquote>
<p>hadoopæœ‰ä»¥ä¸‹4ä¸ªæ–‡ä»¶éœ€è¦é…ç½®ï¼š</p>
<ol>
<li>core-site.xml</li>
<li>hdfs-site.xml</li>
<li>mapred-site.xml</li>
<li>yarn-site.xml</li>
<li>workers</li>
</ol>
<p>è¿›å…¥æ–‡ä»¶æ‰€åœ¨ç›®å½•è¿›è¡Œé…ç½®</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /opt/module/hadoop-3.3.1/etc/hadoop/</span><br></pre></td></tr></table></figure>

<blockquote>
<p>åœ¨</p>
<configuration>

</configuration>

<p>æ ‡ç­¾å†…å¡«å†™é…ç½®å†…å®¹</p>
<p>å¿…éœ€åœ¨æ ‡ç­¾å†…å¡«å†™é…ç½®å†…å®¹ï¼</p>
</blockquote>
<h4 id="core-site-xml"><a href="#core-site-xml" class="headerlink" title="core-site.xml"></a>core-site.xml</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æŒ‡å®šNameNodeçš„åœ°å€ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.defaultFS<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://hadoop102:8020<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- æŒ‡å®šhadoopæ•°æ®çš„å­˜å‚¨ç›®å½• --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/module/hadoop-3.3.1/data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- é…ç½®HDFSç½‘é¡µç™»å½•ä½¿ç”¨çš„é™æ€ç”¨æˆ·ä¸ºluo --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.http.staticuser.user<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>luo<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="hdfs-site-xml"><a href="#hdfs-site-xml" class="headerlink" title="hdfs-site.xml"></a>hdfs-site.xml</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- nn webç«¯è®¿é—®åœ°å€--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.http-address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>hadoop102:9870<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 2nn webç«¯è®¿é—®åœ°å€--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.secondary.http-address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>hadoop104:9868<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="yarn-site-xml"><a href="#yarn-site-xml" class="headerlink" title="yarn-site.xml"></a>yarn-site.xml</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æŒ‡å®šMRèµ°shuffle --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>mapreduce_shuffle<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- æŒ‡å®šResourceManagerçš„åœ°å€--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>hadoop103<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- ç¯å¢ƒå˜é‡çš„ç»§æ‰¿ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.env-whitelist<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAPRED_HOME<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- å¼€å¯æ—¥å¿—èšé›†åŠŸèƒ½ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log-aggregation-enable<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- è®¾ç½®æ—¥å¿—èšé›†æœåŠ¡å™¨åœ°å€ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log.server.url<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>http://hadoop102:19888/jobhistory/logs<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- è®¾ç½®æ—¥å¿—ä¿ç•™æ—¶é—´ä¸º7å¤© --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log-aggregation.retain-seconds<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>604800<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="mapred-site-xml"><a href="#mapred-site-xml" class="headerlink" title="mapred-site.xml"></a>mapred-site.xml</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æŒ‡å®šMapReduceç¨‹åºè¿è¡Œåœ¨Yarnä¸Š --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>yarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- å†å²æœåŠ¡å™¨ç«¯åœ°å€ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>hadoop102:10020<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- å†å²æœåŠ¡å™¨webç«¯åœ°å€ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.webapp.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>hadoop102:19888<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="workers"><a href="#workers" class="headerlink" title="workers"></a>workers</h4><blockquote>
<p>workerså¡«å†™çš„æ˜¯é›†ç¾¤ä¸»æœºçš„æ˜ å°„</p>
<p>ä¸èƒ½å­˜åœ¨å¤šä½™çš„å­—ç¬¦ï¼Œå¦‚ç©ºæ ¼æˆ–è€…å›è½¦</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hadoop102</span><br><span class="line">hadoop103</span><br><span class="line">hadoop104</span><br></pre></td></tr></table></figure>

<h3 id="åˆ†å‘hadoopä»¥åŠå¯åŠ¨"><a href="#åˆ†å‘hadoopä»¥åŠå¯åŠ¨" class="headerlink" title="åˆ†å‘hadoopä»¥åŠå¯åŠ¨"></a>åˆ†å‘hadoopä»¥åŠå¯åŠ¨</h3><blockquote>
<p>ä¸ºæ–¹ä¾¿ç®¡ç†ï¼Œä½¿ç”¨äº†è„šæœ¬è¿›è¡Œåˆ†å‘ä¸å¯åŠ¨</p>
<ol>
<li>jpsall    ï¼ˆæŸ¥çœ‹é›†ç¾¤çŠ¶æ€ï¼‰  </li>
<li>myhadoop.sh     ï¼ˆå¯¹é›†ç¾¤æ“ä½œç®¡ç†ï¼‰</li>
<li>xsync        ï¼ˆåˆ†å‘è„šæœ¬ï¼‰</li>
</ol>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">xsync /opt/module/hadoop-3.3.1/</span><br><span class="line">myhadoop.sh start</span><br></pre></td></tr></table></figure>

<h3 id="æ ¼å¼åŒ–NameNode"><a href="#æ ¼å¼åŒ–NameNode" class="headerlink" title="æ ¼å¼åŒ–NameNode"></a>æ ¼å¼åŒ–NameNode</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /opt/module/hadoop-3.3.1</span><br><span class="line">hdfs namenode -format</span><br></pre></td></tr></table></figure>

<h3 id="ç¼–å†™è„šæœ¬"><a href="#ç¼–å†™è„šæœ¬" class="headerlink" title="ç¼–å†™è„šæœ¬"></a>ç¼–å†™è„šæœ¬</h3><blockquote>
<p>centosç³»ç»Ÿ&#x2F;home&#x2F;user(luo)&#x2F;binç›®å½•é»˜è®¤æ·»åŠ åˆ°PATHï¼Œå…¶ä»–ç‰ˆæœ¬éœ€è¦æ‰‹åŠ¨æ·»åŠ ç¯å¢ƒPATH</p>
<p>åœ¨å¿…éœ€åœ¨åˆ›å»ºçš„binç›®å½•ä¸‹ç¼–å†™è„šæœ¬ æˆ–è€… è‡ªå·±æ·»åŠ åˆ°PATHçš„ç›®å½•</p>
</blockquote>
<p>åˆ›å»ºbinç›®å½•</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> ~/bin</span><br></pre></td></tr></table></figure>

<h4 id="jpsall"><a href="#jpsall" class="headerlink" title="jpsall"></a>jpsall</h4><blockquote>
<p>æ˜ å°„ï¼šæŒ‰è¦æ±‚æ›´æ”¹</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> host <span class="keyword">in</span> hadoop102 hadoop103 hadoop104</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">        <span class="built_in">echo</span> =============== <span class="variable">$host</span> ===============</span><br><span class="line">        ssh <span class="variable">$host</span> jps</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<h4 id="myhadoop-sh"><a href="#myhadoop-sh" class="headerlink" title="myhadoop.sh"></a>myhadoop.sh</h4><blockquote>
<p>æ˜ å°„ã€è·¯å¾„ï¼šæŒ‰è¦æ±‚æ›´æ”¹</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$#</span> -lt 1 ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;No Args Input...&quot;</span></span><br><span class="line">    <span class="built_in">exit</span> ;</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="variable">$1</span> <span class="keyword">in</span></span><br><span class="line"><span class="string">&quot;start&quot;</span>)</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot; =================== å¯åŠ¨ hadoopé›†ç¾¤ ===================&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot; --------------- å¯åŠ¨ hdfs ---------------&quot;</span></span><br><span class="line">        ssh hadoop102 <span class="string">&quot;/opt/module/hadoop-3.3.1/sbin/start-dfs.sh&quot;</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot; --------------- å¯åŠ¨ yarn ---------------&quot;</span></span><br><span class="line">        ssh hadoop103 <span class="string">&quot;/opt/module/hadoop-3.3.1/sbin/start-yarn.sh&quot;</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot; --------------- å¯åŠ¨ historyserver ---------------&quot;</span></span><br><span class="line">        ssh hadoop102 <span class="string">&quot;/opt/module/hadoop-3.3.1/bin/mapred --daemon start historyserver&quot;</span></span><br><span class="line">;;</span><br><span class="line"><span class="string">&quot;stop&quot;</span>)</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot; =================== å…³é—­ hadoopé›†ç¾¤ ===================&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot; --------------- å…³é—­ historyserver ---------------&quot;</span></span><br><span class="line">        ssh hadoop102 <span class="string">&quot;/opt/module/hadoop-3.3.1/bin/mapred --daemon stop historyserver&quot;</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot; --------------- å…³é—­ yarn ---------------&quot;</span></span><br><span class="line">        ssh hadoop103 <span class="string">&quot;/opt/module/hadoop-3.3.1/sbin/stop-yarn.sh&quot;</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot; --------------- å…³é—­ hdfs ---------------&quot;</span></span><br><span class="line">        ssh hadoop102 <span class="string">&quot;/opt/module/hadoop-3.3.1/sbin/stop-dfs.sh&quot;</span></span><br><span class="line">;;</span><br><span class="line">*)</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Input Args Error...&quot;</span></span><br><span class="line">;;</span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure>

<h4 id="xsync"><a href="#xsync" class="headerlink" title="xsync"></a>xsync</h4><blockquote>
<p>æ˜ å°„ï¼šæŒ‰è¦æ±‚æ›´æ”¹</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#1. åˆ¤æ–­å‚æ•°ä¸ªæ•°</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$#</span> -lt 1 ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> Not Enough Arguement!</span><br><span class="line">    <span class="built_in">exit</span>;</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2. éå†é›†ç¾¤æ‰€æœ‰æœºå™¨</span></span><br><span class="line"><span class="keyword">for</span> host <span class="keyword">in</span> hadoop102 hadoop103 hadoop104</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> ====================  <span class="variable">$host</span>  ====================</span><br><span class="line">    <span class="comment">#3. éå†æ‰€æœ‰ç›®å½•ï¼ŒæŒ¨ä¸ªå‘é€</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> file <span class="keyword">in</span> <span class="variable">$@</span></span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">        <span class="comment">#4. åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">        <span class="keyword">if</span> [ -e <span class="variable">$file</span> ]</span><br><span class="line">            <span class="keyword">then</span></span><br><span class="line">                <span class="comment">#5. è·å–çˆ¶ç›®å½•</span></span><br><span class="line">                pdir=$(<span class="built_in">cd</span> -P $(<span class="built_in">dirname</span> <span class="variable">$file</span>); <span class="built_in">pwd</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment">#6. è·å–å½“å‰æ–‡ä»¶çš„åç§°</span></span><br><span class="line">                fname=$(<span class="built_in">basename</span> <span class="variable">$file</span>)</span><br><span class="line">                ssh <span class="variable">$host</span> <span class="string">&quot;mkdir -p <span class="variable">$pdir</span>&quot;</span></span><br><span class="line">                rsync -av <span class="variable">$pdir</span>/<span class="variable">$fname</span> <span class="variable">$host</span>:<span class="variable">$pdir</span></span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="built_in">echo</span> <span class="variable">$file</span> does not exists!</span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">    <span class="keyword">done</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<h4 id="kvm"><a href="#kvm" class="headerlink" title="kvm"></a>kvm</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#/bin/zsh</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="variable">$1</span> <span class="keyword">in</span></span><br><span class="line"><span class="string">&quot;-vm&quot;</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="variable">$2</span> <span class="keyword">in</span></span><br><span class="line">    <span class="string">&quot;start&quot;</span>)</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot; =================== å¯åŠ¨è™šæ‹Ÿæœºç®¡ç†åå°æœåŠ¡ ===================&quot;</span></span><br><span class="line">        sudo systemctl start libvirtd</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot; =================== å¯åŠ¨ default NAT ç½‘ç»œ ===================&quot;</span></span><br><span class="line">        sudo virsh net-start default</span><br><span class="line">    ;;</span><br><span class="line">    <span class="string">&quot;status&quot;</span>)</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot; =================== æ‰€ä»¥è™šæ‹ŸæœºçŠ¶æ€ ===================&quot;</span></span><br><span class="line">        sudo virsh list --all</span><br><span class="line">    ;;</span><br><span class="line">    <span class="keyword">esac</span></span><br><span class="line">;;</span><br><span class="line"><span class="string">&quot;-hadoop&quot;</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="variable">$2</span> <span class="keyword">in</span></span><br><span class="line">    <span class="string">&quot;start&quot;</span>)</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot; =================== å¼€å¯è™šæ‹Ÿæœºï¼šhadoop102 ===================&quot;</span></span><br><span class="line">        sudo virsh start hadoop102</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot; =================== å¼€å¯è™šæ‹Ÿæœºï¼šhadoop103 ===================&quot;</span></span><br><span class="line">        sudo virsh start hadoop103</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot; =================== å¼€å¯è™šæ‹Ÿæœºï¼šhadoop104 ===================&quot;</span></span><br><span class="line">        sudo virsh start hadoop104</span><br><span class="line"></span><br><span class="line">        <span class="built_in">sleep</span> 15s</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot; --------------- å¯åŠ¨ hdfs ---------------&quot;</span></span><br><span class="line">        ssh hadoop102 <span class="string">&quot;/opt/module/hadoop-3.3.1/sbin/start-dfs.sh&quot;</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot; --------------- å¯åŠ¨ yarn ---------------&quot;</span></span><br><span class="line">        ssh hadoop103 <span class="string">&quot;/opt/module/hadoop-3.3.1/sbin/start-yarn.sh&quot;</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot; --------------- å¯åŠ¨ historyserver ---------------&quot;</span></span><br><span class="line">        ssh hadoop102 <span class="string">&quot;/opt/module/hadoop-3.3.1/bin/mapred --daemon start historyserver&quot;</span></span><br><span class="line">    ;;</span><br><span class="line">    <span class="string">&quot;stop&quot;</span>)</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot; --------------- å…³é—­ historyserver ---------------&quot;</span></span><br><span class="line">        ssh hadoop102 <span class="string">&quot;/opt/module/hadoop-3.3.1/bin/mapred --daemon stop historyserver&quot;</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot; --------------- å…³é—­ yarn ---------------&quot;</span></span><br><span class="line">        ssh hadoop103 <span class="string">&quot;/opt/module/hadoop-3.3.1/sbin/stop-yarn.sh&quot;</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot; --------------- å…³é—­ hdfs ---------------&quot;</span></span><br><span class="line">        ssh hadoop102 <span class="string">&quot;/opt/module/hadoop-3.3.1/sbin/stop-dfs.sh&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot; =================== å…³é—­è™šæ‹Ÿæœºï¼šhadoop102 ===================&quot;</span></span><br><span class="line">        sudo virsh shutdown hadoop102</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot; =================== å…³é—­è™šæ‹Ÿæœºï¼šhadoop103 ===================&quot;</span></span><br><span class="line">        sudo virsh shutdown hadoop103</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot; =================== å…³é—­è™šæ‹Ÿæœºï¼šhadoop104 ===================&quot;</span></span><br><span class="line">        sudo virsh shutdown hadoop104</span><br><span class="line">    ;;</span><br><span class="line">    <span class="string">&quot;status&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> host <span class="keyword">in</span> hadoop102 hadoop103 hadoop104</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">            <span class="built_in">echo</span> =============== <span class="variable">$host</span> ===============</span><br><span class="line">            ssh <span class="variable">$host</span> jps</span><br><span class="line">        <span class="keyword">done</span></span><br><span class="line">    ;;</span><br><span class="line">    <span class="keyword">esac</span></span><br><span class="line"></span><br><span class="line">;;</span><br><span class="line">*)</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Input Args Error...&quot;</span></span><br><span class="line">;;</span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure>

<h4 id="èµ‹äºˆæƒé™"><a href="#èµ‹äºˆæƒé™" class="headerlink" title="èµ‹äºˆæƒé™"></a>èµ‹äºˆæƒé™</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x jpsall</span><br><span class="line"><span class="built_in">chmod</span> +x myhadoop.sh</span><br><span class="line"><span class="built_in">chmod</span> +x xsync</span><br></pre></td></tr></table></figure>

<h2 id="yarnç¬”è®°"><a href="#yarnç¬”è®°" class="headerlink" title="yarnç¬”è®°"></a>yarnç¬”è®°</h2><h3 id="Yarnçš„å·¥ä½œæœºåˆ¶"><a href="#Yarnçš„å·¥ä½œæœºåˆ¶" class="headerlink" title="Yarnçš„å·¥ä½œæœºåˆ¶"></a>Yarnçš„å·¥ä½œæœºåˆ¶</h3><h4 id="åŸºæœ¬æµç¨‹"><a href="#åŸºæœ¬æµç¨‹" class="headerlink" title="åŸºæœ¬æµç¨‹"></a>åŸºæœ¬æµç¨‹</h4><ul>
<li>MR ç¨‹åºæäº¤åˆ°å®¢æˆ·ç«¯æ‰€åœ¨çš„èŠ‚ç‚¹ã€‚</li>
<li>YarnRunner å‘ ResourceManager ç”³è¯·ä¸€ä¸ª Applicationã€‚</li>
<li>RM å°†è¯¥åº”ç”¨ç¨‹åºçš„èµ„æºè·¯å¾„è¿”å›ç»™ YarnRunnerã€‚</li>
<li>è¯¥ç¨‹åºå°†è¿è¡Œæ‰€éœ€èµ„æºæäº¤åˆ° HDFS ä¸Šã€‚</li>
<li>ç¨‹åºèµ„æºæäº¤å®Œæ¯•åï¼Œç”³è¯·è¿è¡Œ mrAppMasterã€‚</li>
<li>RM å°†ç”¨æˆ·çš„è¯·æ±‚åˆå§‹åŒ–æˆä¸€ä¸ª Taskã€‚</li>
<li>å…¶ä¸­ä¸€ä¸ª NodeManager é¢†å–åˆ° Task ä»»åŠ¡ã€‚</li>
<li>è¯¥ NodeManager åˆ›å»ºå®¹å™¨ Containerï¼Œå¹¶äº§ç”Ÿ MRAppmasterã€‚</li>
<li>Container ä» HDFS ä¸Šæ‹·è´èµ„æºåˆ°æœ¬åœ°ã€‚ </li>
<li>MRAppmaster å‘ RM ç”³è¯·è¿è¡Œ MapTask èµ„æºã€‚ </li>
<li>RM å°†è¿è¡Œ MapTask ä»»åŠ¡åˆ†é…ç»™å¦å¤–ä¸¤ä¸ª NodeManagerï¼Œå¦ä¸¤ä¸ª NodeManager åˆ† åˆ«é¢†å–ä»»åŠ¡å¹¶åˆ›å»ºå®¹å™¨ã€‚</li>
<li>MR å‘ä¸¤ä¸ªæ¥æ”¶åˆ°ä»»åŠ¡çš„ NodeManager å‘é€ç¨‹åºå¯åŠ¨è„šæœ¬ï¼Œè¿™ä¸¤ä¸ª NodeManager åˆ†åˆ«å¯åŠ¨ MapTaskï¼ŒMapTask å¯¹æ•°æ®åˆ†åŒºæ’åºã€‚ </li>
<li>MrAppMaster ç­‰å¾…æ‰€æœ‰ MapTask è¿è¡Œå®Œæ¯•åï¼Œå‘ RM ç”³è¯·å®¹å™¨ï¼Œè¿è¡Œ ReduceTaskã€‚ </li>
<li>ReduceTask å‘ MapTask è·å–ç›¸åº”åˆ†åŒºçš„æ•°æ®ã€‚</li>
<li>ç¨‹åºè¿è¡Œå®Œæ¯•åï¼ŒMR ä¼šå‘ RM ç”³è¯·æ³¨é”€è‡ªå·±ã€‚</li>
</ul>
<h4 id="æµç¨‹å›¾"><a href="#æµç¨‹å›¾" class="headerlink" title="æµç¨‹å›¾"></a>æµç¨‹å›¾</h4><p><img src="/Hadoop%E6%90%AD%E5%BB%BA%E8%B0%83%E4%BC%98%E7%AC%94%E8%AE%B0/2022-01-16_16-03.png" alt="2022-01-16_16-03"></p>
<h3 id="Yarnæ ¸å¿ƒå‚æ•°é…ç½®"><a href="#Yarnæ ¸å¿ƒå‚æ•°é…ç½®" class="headerlink" title="Yarnæ ¸å¿ƒå‚æ•°é…ç½®"></a>Yarnæ ¸å¿ƒå‚æ•°é…ç½®</h3><blockquote>
<p>æ ¹æ®æœåŠ¡å™¨çš„å…·ä½“æƒ…å†µè¿›è¡Œæ·»åŠ yarn-site.xmlçš„é…ç½®</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é€‰æ‹©è°ƒåº¦å™¨ï¼Œé»˜è®¤å®¹é‡ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">description</span>&gt;</span>The class to use as the resource scheduler.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.scheduler.class<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>org.apache.hadoop.yarn.server.resourcemanager.scheduler.capacity.CapacityScheduler<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- ResourceManagerå¤„ç†è°ƒåº¦å™¨è¯·æ±‚çš„çº¿ç¨‹æ•°é‡,é»˜è®¤50ï¼›å¦‚æœæäº¤çš„ä»»åŠ¡æ•°å¤§äº50ï¼Œå¯ä»¥å¢åŠ è¯¥å€¼ï¼Œä½†æ˜¯ä¸èƒ½è¶…è¿‡3å° * 4çº¿ç¨‹ = 12çº¿ç¨‹ï¼ˆå»é™¤å…¶ä»–åº”ç”¨ç¨‹åºå®é™…ä¸èƒ½è¶…è¿‡8ï¼‰ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">description</span>&gt;</span>Number of threads to handle scheduler interface.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.scheduler.client.thread-count<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>5<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- æ˜¯å¦è®©yarnè‡ªåŠ¨æ£€æµ‹ç¡¬ä»¶è¿›è¡Œé…ç½®ï¼Œé»˜è®¤æ˜¯falseï¼Œå¦‚æœè¯¥èŠ‚ç‚¹æœ‰å¾ˆå¤šå…¶ä»–åº”ç”¨ç¨‹åºï¼Œå»ºè®®æ‰‹åŠ¨é…ç½®ã€‚å¦‚æœè¯¥èŠ‚ç‚¹æ²¡æœ‰å…¶ä»–åº”ç”¨ç¨‹åºï¼Œå¯ä»¥é‡‡ç”¨è‡ªåŠ¨ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">description</span>&gt;</span>Enable auto-detection of node capabilities such as memory and CPU.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.resource.detect-hardware-capabilities<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- æ˜¯å¦å°†è™šæ‹Ÿæ ¸æ•°å½“ä½œCPUæ ¸æ•°ï¼Œé»˜è®¤æ˜¯falseï¼Œé‡‡ç”¨ç‰©ç†CPUæ ¸æ•° --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">description</span>&gt;</span>Flag to determine if logical processors(such as</span><br><span class="line">     hyperthreads) should be counted as cores. Only applicable on Linux</span><br><span class="line">     when yarn.nodemanager.resource.cpu-vcores is set to -1 and</span><br><span class="line">     yarn.nodemanager.resource.detect-hardware-capabilities is true.</span><br><span class="line">     <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.resource.count-logical-processors-as-cores<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- è™šæ‹Ÿæ ¸æ•°å’Œç‰©ç†æ ¸æ•°ä¹˜æ•°ï¼Œé»˜è®¤æ˜¯1.0 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">description</span>&gt;</span>Multiplier to determine how to convert phyiscal cores to</span><br><span class="line">     vcores. This value is used if yarn.nodemanager.resource.cpu-vcores</span><br><span class="line">     is set to -1(which implies auto-calculate vcores) and</span><br><span class="line">     yarn.nodemanager.resource.detect-hardware-capabilities is set to true. The number of vcores will be calculated as number of CPUs * multiplier.</span><br><span class="line">     <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.resource.pcores-vcores-multiplier<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>1.0<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- NodeManagerä½¿ç”¨å†…å­˜æ•°ï¼Œé»˜è®¤8Gï¼Œä¿®æ”¹ä¸º4Gå†…å­˜ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">description</span>&gt;</span>Amount of physical memory, in MB, that can be allocated </span><br><span class="line">     for containers. If set to -1 and</span><br><span class="line">     yarn.nodemanager.resource.detect-hardware-capabilities is true, it is</span><br><span class="line">     automatically calculated(in case of Windows and Linux).</span><br><span class="line">     In other cases, the default is 8192MB.</span><br><span class="line">     <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.resource.memory-mb<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>4096<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- nodemanagerçš„CPUæ ¸æ•°ï¼Œä¸æŒ‰ç…§ç¡¬ä»¶ç¯å¢ƒè‡ªåŠ¨è®¾å®šæ—¶é»˜è®¤æ˜¯8ä¸ªï¼Œä¿®æ”¹ä¸º4ä¸ª --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">description</span>&gt;</span>Number of vcores that can be allocated</span><br><span class="line">     for containers. This is used by the RM scheduler when allocating</span><br><span class="line">     resources for containers. This is not used to limit the number of</span><br><span class="line">     CPUs used by YARN containers. If it is set to -1 and</span><br><span class="line">     yarn.nodemanager.resource.detect-hardware-capabilities is true, it is</span><br><span class="line">     automatically determined from the hardware in case of Windows and Linux.</span><br><span class="line">     In other cases, number of vcores is 8 by default.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.resource.cpu-vcores<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- å®¹å™¨æœ€å°å†…å­˜ï¼Œé»˜è®¤1G --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">description</span>&gt;</span></span><br><span class="line">         The minimum allocation for every container request at the RM in MBs. Memory requests lower than this will be set to the value of this property. Additionally, a node manager that is configured to have less memory than this value will be shut down by the resource manager.</span><br><span class="line">     <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.scheduler.minimum-allocation-mb<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>1024<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- å®¹å™¨æœ€å¤§å†…å­˜ï¼Œé»˜è®¤8Gï¼Œä¿®æ”¹ä¸º2G --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">description</span>&gt;</span></span><br><span class="line">         The maximum allocation for every container request at the RM in MBs. Memory requests higher than this will throw an InvalidResourceRequestException.</span><br><span class="line">     <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.scheduler.maximum-allocation-mb<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>2048<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- å®¹å™¨æœ€å°CPUæ ¸æ•°ï¼Œé»˜è®¤1ä¸ª --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">description</span>&gt;</span></span><br><span class="line">         The minimum allocation for every container request at the RM in terms of virtual CPU cores. Requests lower than this will be set to the value of this property. Additionally, a node manager that is configured to have fewer virtual cores than this value will be shut down by the resource manager.</span><br><span class="line">     <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.scheduler.minimum-allocation-vcores<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- å®¹å™¨æœ€å¤§CPUæ ¸æ•°ï¼Œé»˜è®¤4ä¸ªï¼Œä¿®æ”¹ä¸º2ä¸ª --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">description</span>&gt;</span></span><br><span class="line">         The maximum allocation for every container request at the RM in terms of virtual CPU cores. Requests higher than this will throw an InvalidResourceRequestException.</span><br><span class="line">     <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.scheduler.maximum-allocation-vcores<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- è™šæ‹Ÿå†…å­˜æ£€æŸ¥ï¼Œé»˜è®¤æ‰“å¼€ï¼Œä¿®æ”¹ä¸ºå…³é—­ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">description</span>&gt;</span></span><br><span class="line">         Whether virtual memory limits will be enforced for containers.</span><br><span class="line">     <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.vmem-check-enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- è™šæ‹Ÿå†…å­˜å’Œç‰©ç†å†…å­˜è®¾ç½®æ¯”ä¾‹,é»˜è®¤2.1 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">description</span>&gt;</span></span><br><span class="line">         Ratio between virtual memory to physical memory when setting memory limits for containers. Container allocations are expressed in terms of physical memory, and virtual memory usage is allowed to exceed this allocation by this ratio.</span><br><span class="line">     <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.vmem-pmem-ratio<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>2.1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- å¼€å¯ä¼˜å…ˆçº§ï¼Œæœ‰5ä¸ªç­‰çº§ ï¼ˆï¼‰--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.cluster.max-application-priority<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>5<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="Yarnçš„è°ƒåº¦å™¨"><a href="#Yarnçš„è°ƒåº¦å™¨" class="headerlink" title="Yarnçš„è°ƒåº¦å™¨"></a>Yarnçš„è°ƒåº¦å™¨</h3><blockquote>
<p>åœ¨å®é™…å¼€å‘ä¸­ä¸€èˆ¬ä¸ä½¿ç”¨FIFOè°ƒåº¦å™¨ã€‚</p>
<p>å®¹é‡è°ƒåº¦å™¨ï¼šä¸­å°å‹ä¼ä¸šä½¿ç”¨ï¼Œå¯¹ç¨‹åºå¹¶å‘åº¦è¦æ±‚ä¸é«˜ã€‚</p>
<p>å…¬å¹³è°ƒåº¦å™¨ï¼šä¸­å¤§å‹ä¼ä¸šä½¿ç”¨ï¼Œå¯¹ç¨‹åºå¹¶å‘åº¦è¦æ±‚è¾ƒé«˜ã€‚</p>
</blockquote>
<h4 id="å®¹é‡è°ƒåº¦å™¨"><a href="#å®¹é‡è°ƒåº¦å™¨" class="headerlink" title="å®¹é‡è°ƒåº¦å™¨"></a>å®¹é‡è°ƒåº¦å™¨</h4><h5 id="ç‰¹ç‚¹"><a href="#ç‰¹ç‚¹" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h5><ol>
<li>å¤šé˜Ÿåˆ—ï¼šæ¯ä¸ªé˜Ÿåˆ—å¯é…ç½®ä¸€å®šçš„èµ„æºé‡ï¼Œæ¯ä¸ªé˜Ÿåˆ—é‡‡ç”¨FIFOè°ƒåº¦ç­–ç•¥ã€‚</li>
<li>å®¹é‡ä¿è¯ï¼šç®¡ç†å‘˜å¯ä¸ºæ¯ä¸ªé˜Ÿåˆ—è®¾ç½®èµ„æºæœ€ä½ä¿è¯å’Œèµ„æºä½¿ç”¨ä¸Šé™ </li>
<li>çµæ´»æ€§ï¼šå¦‚æœä¸€ä¸ªé˜Ÿåˆ—ä¸­çš„èµ„æºæœ‰å‰©ä½™ï¼Œå¯ä»¥æš‚æ—¶å…±äº«ç»™é‚£äº›éœ€è¦èµ„æºçš„é˜Ÿåˆ—ï¼Œè€Œä¸€æ—¦è¯¥é˜Ÿåˆ—æœ‰æ–°çš„åº”ç”¨ ç¨‹åºæäº¤ï¼Œåˆ™å…¶ä»–é˜Ÿåˆ—å€Ÿè°ƒçš„èµ„æºä¼šå½’è¿˜ç»™è¯¥é˜Ÿåˆ—ã€‚ </li>
<li>å¤šç§Ÿæˆ·ï¼š æ”¯æŒå¤šç”¨æˆ·å…±äº«é›†ç¾¤å’Œå¤šåº”ç”¨ç¨‹åºåŒæ—¶è¿è¡Œã€‚ ä¸ºäº†é˜²æ­¢åŒä¸€ä¸ªç”¨æˆ·çš„ä½œä¸šç‹¬å é˜Ÿåˆ—ä¸­çš„èµ„æºï¼Œè¯¥è°ƒåº¦å™¨ä¼šå¯¹åŒä¸€ç”¨æˆ·æäº¤çš„ä½œä¸šæ‰€å èµ„æºé‡è¿›è¡Œé™å®š</li>
</ol>
<h5 id="èµ„æºåˆ†é…ç®—æ³•"><a href="#èµ„æºåˆ†é…ç®—æ³•" class="headerlink" title="èµ„æºåˆ†é…ç®—æ³•"></a>èµ„æºåˆ†é…ç®—æ³•</h5><ol>
<li><p>é˜Ÿåˆ—èµ„æºåˆ†é…</p>
<p>ä½¿ç”¨æ·±åº¦ä¼˜å…ˆç®—æ³•ï¼Œä¼˜å…ˆ é€‰æ‹©èµ„æºå ç”¨ç‡æœ€ä½çš„é˜Ÿåˆ—åˆ†é…èµ„æºã€‚</p>
</li>
<li><p>ä½œä¸šèµ„æºåˆ†é…</p>
<p>é»˜è®¤æŒ‰ç…§æäº¤ä½œä¸šçš„ä¼˜å…ˆçº§å’Œæäº¤æ—¶é—´ é¡ºåºåˆ†é…èµ„æºã€‚(FIFO)</p>
</li>
<li><p>å®¹å™¨èµ„æºåˆ†é…</p>
<p>æŒ‰ç…§å®¹å™¨çš„ä¼˜å…ˆçº§åˆ†é…èµ„æºï¼› å¦‚æœä¼˜å…ˆçº§ç›¸åŒï¼ŒæŒ‰ç…§æ•°æ®æœ¬åœ°æ€§åŸåˆ™ï¼š</p>
<ol>
<li>ä»»åŠ¡å’Œæ•°æ®åœ¨åŒä¸€èŠ‚ç‚¹</li>
<li>ä»»åŠ¡å’Œæ•°æ®åœ¨åŒä¸€æœºæ¶ </li>
<li>ä»»åŠ¡å’Œæ•°æ®ä¸åœ¨åŒä¸€èŠ‚ç‚¹ä¹Ÿä¸åœ¨åŒä¸€æœºæ¶</li>
</ol>
</li>
</ol>
<h5 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h5><h6 id="capacity-scheduler-xml"><a href="#capacity-scheduler-xml" class="headerlink" title="capacity-scheduler.xml"></a>capacity-scheduler.xml</h6><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--ï¼ˆ1ï¼‰ä¿®æ”¹é»˜è®¤å±æ€§é…ç½®ï¼š--&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- æŒ‡å®šå¤šé˜Ÿåˆ—ï¼Œå¢åŠ hiveé˜Ÿåˆ— --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.scheduler.capacity.root.queues<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>default,hive<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span></span><br><span class="line">      The queues at the this level (root is the root queue).</span><br><span class="line">    <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- é™ä½defaulté˜Ÿåˆ—èµ„æºé¢å®šå®¹é‡ä¸º40%ï¼Œé»˜è®¤100% --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.scheduler.capacity.root.default.capacity<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>40<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- é™ä½defaulté˜Ÿåˆ—èµ„æºæœ€å¤§å®¹é‡ä¸º60%ï¼Œé»˜è®¤100% --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.scheduler.capacity.root.default.maximum-capacity<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>60<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--ï¼ˆ2ï¼‰ä¸ºæ–°åŠ é˜Ÿåˆ—æ·»åŠ å¿…è¦å±æ€§ï¼š--&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- æŒ‡å®šhiveé˜Ÿåˆ—çš„èµ„æºé¢å®šå®¹é‡ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.scheduler.capacity.root.hive.capacity<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>60<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- ç”¨æˆ·æœ€å¤šå¯ä»¥ä½¿ç”¨é˜Ÿåˆ—å¤šå°‘èµ„æºï¼Œ1è¡¨ç¤º --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.scheduler.capacity.root.hive.user-limit-factor<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- æŒ‡å®šhiveé˜Ÿåˆ—çš„èµ„æºæœ€å¤§å®¹é‡ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.scheduler.capacity.root.hive.maximum-capacity<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>80<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- å¯åŠ¨hiveé˜Ÿåˆ— --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.scheduler.capacity.root.hive.state<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>RUNNING<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- å“ªäº›ç”¨æˆ·æœ‰æƒå‘é˜Ÿåˆ—æäº¤ä½œä¸š --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.scheduler.capacity.root.hive.acl_submit_applications<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>*<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- å“ªäº›ç”¨æˆ·æœ‰æƒæ“ä½œé˜Ÿåˆ—ï¼Œç®¡ç†å‘˜æƒé™ï¼ˆæŸ¥çœ‹/æ€æ­»ï¼‰ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.scheduler.capacity.root.hive.acl_administer_queue<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>*<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- å“ªäº›ç”¨æˆ·æœ‰æƒé…ç½®æäº¤ä»»åŠ¡ä¼˜å…ˆçº§ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.scheduler.capacity.root.hive.acl_application_max_priority<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>*<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- ä»»åŠ¡çš„è¶…æ—¶æ—¶é—´è®¾ç½®ï¼šyarn application -appId appId -updateLifetime Timeout</span></span><br><span class="line"><span class="comment">å‚è€ƒèµ„æ–™ï¼šhttps://blog.cloudera.com/enforcing-application-lifetime-slas-yarn/ --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- å¦‚æœapplicationæŒ‡å®šäº†è¶…æ—¶æ—¶é—´ï¼Œåˆ™æäº¤åˆ°è¯¥é˜Ÿåˆ—çš„applicationèƒ½å¤ŸæŒ‡å®šçš„æœ€å¤§è¶…æ—¶æ—¶é—´ä¸èƒ½è¶…è¿‡è¯¥å€¼ã€‚ </span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.scheduler.capacity.root.hive.maximum-application-lifetime<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- å¦‚æœapplicationæ²¡æŒ‡å®šè¶…æ—¶æ—¶é—´ï¼Œåˆ™ç”¨default-application-lifetimeä½œä¸ºé»˜è®¤å€¼ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.scheduler.capacity.root.hive.default-application-lifetime<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="å…¬å¹³è°ƒåº¦å™¨"><a href="#å…¬å¹³è°ƒåº¦å™¨" class="headerlink" title="å…¬å¹³è°ƒåº¦å™¨"></a>å…¬å¹³è°ƒåº¦å™¨</h4><blockquote>
<p>åœ¨Apacheçš„hadoopä¸­é»˜è®¤çš„æ˜¯å®¹é‡è°ƒåº¦å™¨ï¼Œå¦‚æœéœ€è¦ä¿®æ”¹ä¸ºå…¬å¹³è°ƒåº¦å™¨ï¼Œéœ€è¦ä¿®æ”¹yarn-site.xmlæ–‡ä»¶æŒ‡å®šå®¹å™¨ç±»å‹ã€‚</p>
</blockquote>
<h5 id="ç‰¹ç‚¹-1"><a href="#ç‰¹ç‚¹-1" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h5><ol>
<li>å¤šé˜Ÿåˆ—ï¼šæ¯ä¸ªé˜Ÿåˆ—å¯é…ç½®ä¸€å®šçš„èµ„æºé‡ï¼Œæ¯ä¸ªé˜Ÿåˆ—é‡‡ç”¨FIFOè°ƒåº¦ç­–ç•¥ã€‚</li>
<li>å®¹é‡ä¿è¯ï¼šç®¡ç†å‘˜å¯ä¸ºæ¯ä¸ªé˜Ÿåˆ—è®¾ç½®èµ„æºæœ€ä½ä¿è¯å’Œèµ„æºä½¿ç”¨ä¸Šé™ </li>
<li>çµæ´»æ€§ï¼šå¦‚æœä¸€ä¸ªé˜Ÿåˆ—ä¸­çš„èµ„æºæœ‰å‰©ä½™ï¼Œå¯ä»¥æš‚æ—¶å…±äº«ç»™é‚£äº›éœ€è¦èµ„æºçš„é˜Ÿåˆ—ï¼Œè€Œä¸€æ—¦è¯¥é˜Ÿåˆ—æœ‰æ–°çš„åº”ç”¨ ç¨‹åºæäº¤ï¼Œåˆ™å…¶ä»–é˜Ÿåˆ—å€Ÿè°ƒçš„èµ„æºä¼šå½’è¿˜ç»™è¯¥é˜Ÿåˆ—ã€‚ </li>
<li>å¤šç§Ÿæˆ·ï¼š æ”¯æŒå¤šç”¨æˆ·å…±äº«é›†ç¾¤å’Œå¤šåº”ç”¨ç¨‹åºåŒæ—¶è¿è¡Œã€‚ ä¸ºäº†é˜²æ­¢åŒä¸€ä¸ªç”¨æˆ·çš„ä½œä¸šç‹¬å é˜Ÿåˆ—ä¸­çš„èµ„æºï¼Œè¯¥è°ƒåº¦å™¨ä¼šå¯¹åŒä¸€ç”¨æˆ·æäº¤çš„ä½œä¸šæ‰€å èµ„æºé‡è¿›è¡Œé™å®š</li>
</ol>
<h5 id="èµ„æºåˆ†é…ç®—æ³•-1"><a href="#èµ„æºåˆ†é…ç®—æ³•-1" class="headerlink" title="èµ„æºåˆ†é…ç®—æ³•"></a>èµ„æºåˆ†é…ç®—æ³•</h5><blockquote>
<p>ç¼ºé¢ï¼šä½œä¸šè·å–èµ„æºçš„è¿‡ç¨‹å¹¶ä¸æ˜¯ç¬é—´å¾—åˆ°ï¼Œè€Œæ˜¯åœ¨ä¸€æ®µæ—¶é—´å†…ä¸æ–­è·å–ã€‚æŸä¸ªä»»åŠ¡ç†æƒ³ä¸­å¾—åˆ°çš„èµ„æºä¸ç°æœ‰çš„èµ„æºçš„å·®å€¼å°±æ˜¯ç¼ºé¢</p>
<p>å…¬å¹³è°ƒåº¦å™¨è®¾è®¡ç›®æ ‡æ˜¯ï¼šåœ¨æ—¶é—´å°ºåº¦ä¸Šï¼Œæ‰€æœ‰ä½œä¸šè·å¾—å…¬å¹³çš„èµ„æºã€‚æŸä¸€ æ—¶åˆ»ä¸€ä¸ªä½œä¸šåº”è·èµ„æºå’Œå®é™…è·å–èµ„æºçš„å·®è·å«â€œç¼ºé¢â€ ï¼Œè°ƒåº¦å™¨ä¼šä¼˜å…ˆä¸ºç¼ºé¢å¤§çš„ä½œä¸šåˆ†é…èµ„ã€‚(Fair)</p>
</blockquote>
<p> Fair ç­–ç•¥ï¼ˆé»˜è®¤ï¼‰æ˜¯ä¸€ç§åŸºäºæœ€å¤§æœ€å°å…¬å¹³ç®—æ³•å®ç°çš„èµ„æºå¤šè·¯å¤ç”¨æ–¹å¼ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ªé˜Ÿåˆ—å†…éƒ¨é‡‡ç”¨è¯¥æ–¹å¼åˆ†é…èµ„ æºã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœä¸€ä¸ªé˜Ÿåˆ—ä¸­æœ‰ä¸¤ä¸ªåº”ç”¨ç¨‹åºåŒæ—¶è¿è¡Œï¼Œåˆ™æ¯ä¸ªåº”ç”¨ç¨‹åºå¯å¾—åˆ°1&#x2F;2çš„èµ„æºï¼›å¦‚æœä¸‰ä¸ªåº”ç”¨ç¨‹åºåŒæ—¶è¿è¡Œï¼Œåˆ™ æ¯ä¸ªåº”ç”¨ç¨‹åºå¯å¾—åˆ°1&#x2F;3çš„èµ„æºã€‚ åˆ†åˆ«è®¡ç®—æ¯”è¾ƒå¯¹è±¡çš„ï¼ˆå®é™…æœ€å°èµ„æºä»½é¢ã€æ˜¯ å¦é¥¥é¥¿ã€èµ„æºåˆ†é…æ¯”ã€èµ„æºä½¿ç”¨æƒé‡æ¯”ï¼‰ å…·ä½“èµ„æºåˆ†é…æµç¨‹å’Œå®¹é‡è°ƒåº¦å™¨ä¸€è‡´ï¼›</p>
<ol>
<li>é˜Ÿåˆ—èµ„æºåˆ†é…</li>
<li>ä½œä¸šèµ„æºåˆ†é…</li>
<li>å®¹å™¨èµ„æºåˆ†é…</li>
</ol>
<p>ä»¥ä¸Šä¸‰æ­¥ï¼Œæ¯ä¸€æ­¥éƒ½æ˜¯æŒ‰ç…§å…¬å¹³ç­–ç•¥åˆ†é…èµ„æº</p>
<p>â¢ å®é™…æœ€å°èµ„æºä»½é¢ï¼šmindshare &#x3D; Minï¼ˆèµ„æºéœ€æ±‚é‡ï¼Œé…ç½®çš„æœ€å°èµ„æºï¼‰ </p>
<p>â¢ æ˜¯å¦é¥¥é¥¿ï¼šisNeedy &#x3D; èµ„æºä½¿ç”¨é‡ &lt; mindshareï¼ˆå®é™…æœ€å°èµ„æºä»½é¢ï¼‰ </p>
<p>â¢ èµ„æºåˆ†é…æ¯”ï¼šminShareRatio &#x3D; èµ„æºä½¿ç”¨é‡ &#x2F; Maxï¼ˆmindshare, 1ï¼‰ </p>
<p>â¢ èµ„æºä½¿ç”¨æƒé‡æ¯”ï¼šuseToWeightRatio &#x3D; èµ„æºä½¿ç”¨é‡ &#x2F; æƒé‡</p>
<h5 id="é…ç½®æ–‡ä»¶-1"><a href="#é…ç½®æ–‡ä»¶-1" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h5><h6 id="yarn-site-xml-1"><a href="#yarn-site-xml-1" class="headerlink" title="yarn-site.xml"></a>yarn-site.xml</h6><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.scheduler.class<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>org.apache.hadoop.yarn.server.resourcemanager.scheduler.fair.FairS</span><br><span class="line">cheduler<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">description</span>&gt;</span>é…ç½®ä½¿ç”¨å…¬å¹³è°ƒåº¦å™¨<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.scheduler.fair.allocation.file<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/module/hadoop-3.3.1/etc/hadoop/fair-scheduler.xml<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">description</span>&gt;</span>æŒ‡æ˜å…¬å¹³è°ƒåº¦å™¨é˜Ÿåˆ—åˆ†é…é…ç½®æ–‡ä»¶<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.scheduler.fair.preemption<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">description</span>&gt;</span>ç¦æ­¢é˜Ÿåˆ—é—´èµ„æºæŠ¢å <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h6 id="fair-scheduler-xml"><a href="#fair-scheduler-xml" class="headerlink" title="fair-scheduler.xml"></a>fair-scheduler.xml</h6><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">allocations</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!-- å•ä¸ªé˜Ÿåˆ—ä¸­ Application Master å ç”¨èµ„æºçš„æœ€å¤§æ¯”ä¾‹,å–å€¼ 0-1 ï¼Œä¼ä¸šä¸€èˆ¬é…ç½® 0.1 --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">queueMaxAMShareDefault</span>&gt;</span>0.5<span class="tag">&lt;/<span class="name">queueMaxAMShareDefault</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!-- å•ä¸ªé˜Ÿåˆ—æœ€å¤§èµ„æºçš„é»˜è®¤å€¼ test luo default --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">queueMaxResourcesDefault</span>&gt;</span>4096mb,4vcores<span class="tag">&lt;/<span class="name">queueMaxResourcesDefault</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!-- å¢åŠ ä¸€ä¸ªé˜Ÿåˆ— test --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">queue</span> <span class="attr">name</span>=<span class="string">&quot;test&quot;</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!-- é˜Ÿåˆ—æœ€å°èµ„æº --&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">minResources</span>&gt;</span>2048mb,2vcores<span class="tag">&lt;/<span class="name">minResources</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!-- é˜Ÿåˆ—æœ€å¤§èµ„æº --&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">maxResources</span>&gt;</span>4096mb,4vcores<span class="tag">&lt;/<span class="name">maxResources</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!-- é˜Ÿåˆ—ä¸­æœ€å¤šåŒæ—¶è¿è¡Œçš„åº”ç”¨æ•°ï¼Œé»˜è®¤ 50ï¼Œæ ¹æ®çº¿ç¨‹æ•°é…ç½® --&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">maxRunningApps</span>&gt;</span>4<span class="tag">&lt;/<span class="name">maxRunningApps</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!-- é˜Ÿåˆ—ä¸­ Application Master å ç”¨èµ„æºçš„æœ€å¤§æ¯”ä¾‹ --&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">maxAMShare</span>&gt;</span>0.5<span class="tag">&lt;/<span class="name">maxAMShare</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!-- è¯¥é˜Ÿåˆ—èµ„æºæƒé‡,é»˜è®¤å€¼ä¸º 1.0 --&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">weight</span>&gt;</span>1.0<span class="tag">&lt;/<span class="name">weight</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!-- é˜Ÿåˆ—å†…éƒ¨çš„èµ„æºåˆ†é…ç­–ç•¥ --&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">schedulingPolicy</span>&gt;</span>fair<span class="tag">&lt;/<span class="name">schedulingPolicy</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">queue</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!-- å¢åŠ ä¸€ä¸ªé˜Ÿåˆ— luo --&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">queue</span> <span class="attr">name</span>=<span class="string">&quot;luo&quot;</span> <span class="attr">type</span>=<span class="string">&quot;parent&quot;</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!-- é˜Ÿåˆ—æœ€å°èµ„æº --&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">minResources</span>&gt;</span>2048mb,2vcores<span class="tag">&lt;/<span class="name">minResources</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!-- é˜Ÿåˆ—æœ€å¤§èµ„æº --&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">maxResources</span>&gt;</span>4096mb,4vcores<span class="tag">&lt;/<span class="name">maxResources</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!-- é˜Ÿåˆ—ä¸­æœ€å¤šåŒæ—¶è¿è¡Œçš„åº”ç”¨æ•°ï¼Œé»˜è®¤ 50ï¼Œæ ¹æ®çº¿ç¨‹æ•°é…ç½® --&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">maxRunningApps</span>&gt;</span>4<span class="tag">&lt;/<span class="name">maxRunningApps</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!-- é˜Ÿåˆ—ä¸­ Application Master å ç”¨èµ„æºçš„æœ€å¤§æ¯”ä¾‹ --&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">maxAMShare</span>&gt;</span>0.5<span class="tag">&lt;/<span class="name">maxAMShare</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!-- è¯¥é˜Ÿåˆ—èµ„æºæƒé‡,é»˜è®¤å€¼ä¸º 1.0 --&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">weight</span>&gt;</span>1.0<span class="tag">&lt;/<span class="name">weight</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!-- é˜Ÿåˆ—å†…éƒ¨çš„èµ„æºåˆ†é…ç­–ç•¥ --&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">schedulingPolicy</span>&gt;</span>fair<span class="tag">&lt;/<span class="name">schedulingPolicy</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">queue</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!-- ä»»åŠ¡é˜Ÿåˆ—åˆ†é…ç­–ç•¥,å¯é…ç½®å¤šå±‚è§„åˆ™,ä»ç¬¬ä¸€ä¸ªè§„åˆ™å¼€å§‹åŒ¹é…,ç›´åˆ°åŒ¹é…æˆåŠŸ --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">queuePlacementPolicy</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!-- æäº¤ä»»åŠ¡æ—¶æŒ‡å®šé˜Ÿåˆ—,å¦‚æœªæŒ‡å®šæäº¤é˜Ÿåˆ—,åˆ™ç»§ç»­åŒ¹é…ä¸‹ä¸€ä¸ªè§„åˆ™; false è¡¨ç¤ºï¼šå¦‚æœæŒ‡</span></span><br><span class="line"><span class="comment">        å®šé˜Ÿåˆ—ä¸å­˜åœ¨,ä¸å…è®¸è‡ªåŠ¨åˆ›å»º--&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">rule</span> <span class="attr">name</span>=<span class="string">&quot;specified&quot;</span> <span class="attr">create</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line">         <span class="comment">&lt;!-- æäº¤åˆ° root.group.username é˜Ÿåˆ—,è‹¥ root.group ä¸å­˜åœ¨,ä¸å…è®¸è‡ªåŠ¨åˆ›å»ºï¼›è‹¥</span></span><br><span class="line"><span class="comment">        root.group.user ä¸å­˜åœ¨,å…è®¸è‡ªåŠ¨åˆ›å»º --&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">rule</span> <span class="attr">name</span>=<span class="string">&quot;nestedUserQueue&quot;</span> <span class="attr">create</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">rule</span> <span class="attr">name</span>=<span class="string">&quot;primaryGroup&quot;</span> <span class="attr">create</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">rule</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!-- æœ€åä¸€ä¸ªè§„åˆ™å¿…é¡»ä¸º reject æˆ–è€… defaultã€‚Reject è¡¨ç¤ºæ‹’ç»åˆ›å»ºæäº¤å¤±è´¥ï¼Œ</span></span><br><span class="line"><span class="comment">        default è¡¨ç¤ºæŠŠä»»åŠ¡æäº¤åˆ° default é˜Ÿåˆ— --&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">rule</span> <span class="attr">name</span>=<span class="string">&quot;reject&quot;</span> /&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">queuePlacementPolicy</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">allocations</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="Toolæ¥å£çš„ç¼–å†™"><a href="#Toolæ¥å£çš„ç¼–å†™" class="headerlink" title="Toolæ¥å£çš„ç¼–å†™"></a>Toolæ¥å£çš„ç¼–å†™</h3><blockquote>
<p>ä¸ºäº†æ–¹ä¾¿å¯¹ç¨‹åºçš„ä½¿ç”¨ç¼–å†™æ¥å£</p>
<p>ä»¥WordCountä¸ºä¾‹</p>
</blockquote>
<h4 id="WordCount"><a href="#WordCount" class="headerlink" title="WordCount"></a>WordCount</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luo.TOOæ¥å£æ¡ˆä¾‹;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.Path;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.LongWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Job;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Reducer;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.input.FileInputFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.util.Tool;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WordCount</span> <span class="keyword">implements</span> <span class="title class_">Tool</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Configuration conf;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">run</span><span class="params">(String[] strings)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">Job</span> <span class="variable">job</span> <span class="operator">=</span> Job.getInstance(conf);</span><br><span class="line"></span><br><span class="line">        job.setJarByClass(WordCountDriver.class);</span><br><span class="line">        job.setMapperClass(WCMapper.class);</span><br><span class="line">        job.setReducerClass(WCReducer.class);</span><br><span class="line"></span><br><span class="line">        job.setMapOutputKeyClass(Text.class);</span><br><span class="line">        job.setMapOutputValueClass(IntWritable.class);</span><br><span class="line">        job.setOutputKeyClass(Text.class);</span><br><span class="line">        job.setOutputValueClass(IntWritable.class);</span><br><span class="line"></span><br><span class="line">        FileInputFormat.setInputPaths(job, <span class="keyword">new</span> <span class="title class_">Path</span>(strings[<span class="number">0</span>]));</span><br><span class="line">        FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> <span class="title class_">Path</span>(strings[<span class="number">1</span>]));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> job.waitForCompletion(<span class="literal">true</span>) ? <span class="number">0</span> : <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setConf</span><span class="params">(Configuration configuration)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.conf = configuration;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Configuration <span class="title function_">getConf</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> conf;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">WCMapper</span> <span class="keyword">extends</span> <span class="title class_">Mapper</span>&lt;LongWritable, Text, Text, IntWritable&gt; &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">Text</span> <span class="variable">outK</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Text</span>();</span><br><span class="line">        <span class="keyword">private</span> <span class="type">IntWritable</span> <span class="variable">outV</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IntWritable</span>(<span class="number">1</span>);</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">map</span><span class="params">(LongWritable key, Text value, Mapper&lt;LongWritable, Text, Text, IntWritable&gt;.Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> value.toString();</span><br><span class="line">            <span class="keyword">for</span> (String s : line.split(<span class="string">&quot; &quot;</span>)) &#123;</span><br><span class="line">                outK.set(s);</span><br><span class="line">                context.write(outK, outV);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">WCReducer</span> <span class="keyword">extends</span> <span class="title class_">Reducer</span>&lt;Text, IntWritable, Text, IntWritable&gt; &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">IntWritable</span> <span class="variable">outV</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IntWritable</span>();</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">reduce</span><span class="params">(Text key, Iterable&lt;IntWritable&gt; values, Reducer&lt;Text, IntWritable, Text, IntWritable&gt;.Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (IntWritable value : values) &#123;</span><br><span class="line">                sum += value.get();</span><br><span class="line">            &#125;</span><br><span class="line">            outV.set(sum);</span><br><span class="line">            context.write(key, outV);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="WordCountDriver"><a href="#WordCountDriver" class="headerlink" title="WordCountDriver"></a>WordCountDriver</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luo.TOOæ¥å£æ¡ˆä¾‹;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.util.Tool;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.util.ToolRunner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WordCountDriver</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Tool tool;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Configuration</span> <span class="variable">conf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> (args[<span class="number">0</span>])&#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;wordcount&quot;</span>:</span><br><span class="line">                tool = <span class="keyword">new</span> <span class="title class_">WordCount</span>();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                System.out.println(<span class="string">&quot;éæ³•æ¥å£ï¼š&quot;</span> + args[<span class="number">0</span>]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">run</span> <span class="operator">=</span> ToolRunner.run(conf, tool, Arrays.copyOfRange(args, args.length - <span class="number">2</span>, args.length));</span><br><span class="line">        System.exit(run);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ç”Ÿäº§è°ƒä¼˜"><a href="#ç”Ÿäº§è°ƒä¼˜" class="headerlink" title="ç”Ÿäº§è°ƒä¼˜"></a>ç”Ÿäº§è°ƒä¼˜</h2><h3 id="HDFSâ€”æ ¸å¿ƒå‚æ•°"><a href="#HDFSâ€”æ ¸å¿ƒå‚æ•°" class="headerlink" title="HDFSâ€”æ ¸å¿ƒå‚æ•°"></a>HDFSâ€”æ ¸å¿ƒå‚æ•°</h3><h4 id="NameNodeã€DataNodeå†…å­˜ç”Ÿäº§é…ç½®"><a href="#NameNodeã€DataNodeå†…å­˜ç”Ÿäº§é…ç½®" class="headerlink" title="NameNodeã€DataNodeå†…å­˜ç”Ÿäº§é…ç½®"></a>NameNodeã€DataNodeå†…å­˜ç”Ÿäº§é…ç½®</h4><h5 id="NameNodeå†…å­˜è®¡ç®—"><a href="#NameNodeå†…å­˜è®¡ç®—" class="headerlink" title="NameNodeå†…å­˜è®¡ç®—"></a>NameNodeå†…å­˜è®¡ç®—</h5><p>æ¯ä¸ªæ–‡ä»¶å—å¤§æ¦‚å ç”¨ 150byteã€‚ä¸€å°æœåŠ¡å™¨ 128G å†…å­˜ä¸ºä¾‹ï¼Œèƒ½å­˜å‚¨128 * 1024 * 1024 * 1024 &#x2F; 150Byte â‰ˆ 9.1 äº¿</p>
<h5 id="é…ç½®-NameNodeã€DataNodeå†…å­˜"><a href="#é…ç½®-NameNodeã€DataNodeå†…å­˜" class="headerlink" title="é…ç½® NameNodeã€DataNodeå†…å­˜"></a>é…ç½® NameNodeã€DataNodeå†…å­˜</h5><blockquote>
<p>åœ¨Hadoop3.x ç³»åˆ—ä¸­é»˜è®¤NameNodeæ˜¯æ ¹æ®æœåŠ¡å™¨åŠ¨æ€åˆ†é…çš„ã€‚</p>
<p>é…ç½®æ–‡ä»¶ï¼šhadoop-env.sh</p>
</blockquote>
<p>é…ç½®ç­–ç•¥ï¼š</p>
<ol>
<li>NameNodeï¼šæœ€å°å€¼ä¸º1Gï¼Œæ¯å¢åŠ 1000000ä¸ªblockï¼Œå¢åŠ 1Gå†…å­˜</li>
<li>DataNodeï¼šåœ¨ä¸€ä¸ªDataNodeä¸Šçš„å‰¯æœ¬æ€»æ•°ä½äº4000000ï¼Œè°ƒä¸º4Gã€‚è¶…è¿‡4000000ï¼Œæ¯å¢åŠ 1000000ï¼Œå¢åŠ 1G</li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">export HDFS_NAMENODE_OPTS=&quot;-Dhadoop.security.logger=INFO,RFAS -Xmx1024m&quot;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">å½“å‰æœºå™¨ä¸ºå­¦ä¹ æœºå™¨ï¼Œæ‰€ä»¥è°ƒä¸º1Gã€‚</span></span><br><span class="line">export HDFS_DATANODE_OPTS=&quot;-Dhadoop.security.logger=ERROR,RFAS -Xmx1024m&quot;</span><br></pre></td></tr></table></figure>

<h4 id="NameNode-å¿ƒè·³å¹¶å‘é…ç½®"><a href="#NameNode-å¿ƒè·³å¹¶å‘é…ç½®" class="headerlink" title="NameNode å¿ƒè·³å¹¶å‘é…ç½®"></a>NameNode å¿ƒè·³å¹¶å‘é…ç½®</h4><blockquote>
<p>NameNode æœ‰ä¸€ä¸ªå·¥ä½œçº¿ç¨‹æ± ï¼Œç”¨æ¥å¤„ç†ä¸åŒ DataNode çš„å¹¶å‘å¿ƒè·³ä»¥åŠå®¢æˆ·ç«¯å¹¶å‘ çš„å…ƒæ•°æ®æ“ä½œã€‚ å¯¹äºå¤§é›†ç¾¤æˆ–è€…æœ‰å¤§é‡å®¢æˆ·ç«¯çš„é›†ç¾¤æ¥è¯´ï¼Œé€šå¸¸éœ€è¦å¢å¤§è¯¥å‚æ•°ã€‚é»˜è®¤å€¼æ˜¯ 10ã€‚</p>
<p>é…ç½®æ–‡ä»¶ï¼šhdfs-site.xml</p>
</blockquote>
<p>ä¼ä¸šç»éªŒï¼šdfs.namenode.handler.count&#x3D;20 Ã— logä»¥eä¸ºåº•çš„é›†ç¾¤æ•°é‡ï¼Œæ¯”å¦‚é›†ç¾¤è§„æ¨¡ï¼ˆDataNode å°æ•°ï¼‰ä¸º 3 å°æ—¶ï¼Œæ­¤å‚æ•°è®¾ç½®ä¸º 21ã€‚<br>ä½¿ç”¨Pythonè®¡ç®—ï¼šprint(int(20*math.log(3)))<br>$$<br>dfs.namenode.handler.count&#x3D;20 Ã— log_{e}^{n}<br>$$</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.handler.count<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">value</span>&gt;</span>21<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="å¼€å¯å›æ”¶ç«™é…ç½®"><a href="#å¼€å¯å›æ”¶ç«™é…ç½®" class="headerlink" title="å¼€å¯å›æ”¶ç«™é…ç½®"></a>å¼€å¯å›æ”¶ç«™é…ç½®</h4><blockquote>
<p>å¼€å¯å›æ”¶ç«™åŠŸèƒ½ï¼Œå¯ä»¥å°†åˆ é™¤çš„æ–‡ä»¶åœ¨ä¸è¶…æ—¶çš„æƒ…å†µä¸‹ï¼Œæ¢å¤åŸæ•°æ®ï¼Œèµ·åˆ°é˜²æ­¢è¯¯åˆ é™¤ã€ å¤‡ä»½ç­‰ä½œç”¨ã€‚</p>
<p>å•ä½ä¸ºåˆ†é’Ÿã€‚0 è¡¨ç¤ºç¦ç”¨å›æ”¶ç«™ï¼›å…¶ä»–å€¼è¡¨ç¤ºè®¾ç½®æ–‡ä»¶çš„å­˜æ´»æ—¶é—´ã€‚</p>
<p>é…ç½®æ–‡ä»¶ ï¼šcore-site.xml</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.trash.interval<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">value</span>&gt;</span>1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="HDFSâ€”å¤šç›®å½•"><a href="#HDFSâ€”å¤šç›®å½•" class="headerlink" title="HDFSâ€”å¤šç›®å½•"></a>HDFSâ€”å¤šç›®å½•</h3><h4 id="NameNode-å¤šç›®å½•é…ç½®"><a href="#NameNode-å¤šç›®å½•é…ç½®" class="headerlink" title="NameNode å¤šç›®å½•é…ç½®"></a>NameNode å¤šç›®å½•é…ç½®</h4><blockquote>
<p>NameNode çš„æœ¬åœ°ç›®å½•å¯ä»¥é…ç½®æˆå¤šä¸ªï¼Œä¸”æ¯ä¸ªç›®å½•å­˜æ”¾å†…å®¹ç›¸åŒï¼Œå¢åŠ äº†å¯é æ€§ã€‚</p>
<p>åœ¨ hdfs-site.xml æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.name.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>file://$&#123;hadoop.tmp.dir&#125;/dfs/name1,file://$&#123;hadoop.tmp.dir&#125;/dfs/name2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>é‡å¯é›†ç¾¤</p>
<p>åœæ­¢é›†ç¾¤ï¼Œåˆ é™¤ä¸‰å°èŠ‚ç‚¹çš„ data å’Œ logs ä¸­æ‰€æœ‰æ•°æ®ã€‚</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[luo@hadoop102 hadoop-3.3.1]$ rm -rf data/ logs/</span><br><span class="line">[luo@hadoop103 hadoop-3.3.1]$ rm -rf data/ logs/</span><br><span class="line">[luo@hadoop104 hadoop-3.3.1]$ rm -rf data/ logs/</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ ¼å¼åŒ–é›†ç¾¤å¹¶å¯åŠ¨ã€‚</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[luo@hadoop102 hadoop-3.3.1]$ bin/hdfs namenode -format</span><br><span class="line">[luo@hadoop102 hadoop-3.3.1]$ sbin/start-dfs.sh</span><br></pre></td></tr></table></figure>

<h4 id="DataNode-å¤šç›®å½•é…ç½®"><a href="#DataNode-å¤šç›®å½•é…ç½®" class="headerlink" title="DataNode å¤šç›®å½•é…ç½®"></a>DataNode å¤šç›®å½•é…ç½®</h4><blockquote>
<p>DataNode å¯ä»¥é…ç½®æˆå¤šä¸ªç›®å½•ï¼Œæ¯ä¸ªç›®å½•å­˜å‚¨çš„æ•°æ®ä¸ä¸€æ ·ï¼ˆæ•°æ®ä¸æ˜¯å‰¯æœ¬ï¼‰</p>
<p>åœ¨ hdfs-site.xml æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.datanode.data.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>file://$&#123;hadoop.tmp.dir&#125;/dfs/data1,file://$&#123;hadoop.tmp.dir&#125;/dfs/data2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="é›†ç¾¤æ•°æ®å‡è¡¡ä¹‹ç£ç›˜é—´æ•°æ®å‡è¡¡"><a href="#é›†ç¾¤æ•°æ®å‡è¡¡ä¹‹ç£ç›˜é—´æ•°æ®å‡è¡¡" class="headerlink" title="é›†ç¾¤æ•°æ®å‡è¡¡ä¹‹ç£ç›˜é—´æ•°æ®å‡è¡¡"></a>é›†ç¾¤æ•°æ®å‡è¡¡ä¹‹ç£ç›˜é—´æ•°æ®å‡è¡¡</h4><blockquote>
<p>ç”Ÿäº§ç¯å¢ƒï¼Œç”±äºç¡¬ç›˜ç©ºé—´ä¸è¶³ï¼Œå¾€å¾€éœ€è¦å¢åŠ ä¸€å—ç¡¬ç›˜ã€‚åˆšåŠ è½½çš„ç¡¬ç›˜æ²¡æœ‰æ•°æ®æ—¶ï¼Œå¯ ä»¥æ‰§è¡Œç£ç›˜æ•°æ®å‡è¡¡å‘½ä»¤ã€‚ï¼ˆHadoop3.x æ–°ç‰¹æ€§ï¼‰</p>
</blockquote>
<ol>
<li>ç”Ÿæˆå‡è¡¡è®¡åˆ’ï¼ˆæˆ‘ä»¬åªæœ‰ä¸€å—ç£ç›˜ï¼Œä¸ä¼šç”Ÿæˆè®¡åˆ’ï¼‰</li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hdfs diskbalancer -plan hadoop103 </span><br></pre></td></tr></table></figure>

<ol start="2">
<li>æ‰§è¡Œå‡è¡¡è®¡åˆ’</li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hdfs diskbalancer -execute hadoop103.plan.json </span><br></pre></td></tr></table></figure>

<ol start="3">
<li>æŸ¥çœ‹å½“å‰å‡è¡¡ä»»åŠ¡çš„æ‰§è¡Œæƒ…å†µ</li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hdfs diskbalancer -query hadoop103 </span><br></pre></td></tr></table></figure>

<ol start="4">
<li>å–æ¶ˆå‡è¡¡ä»»åŠ¡</li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hdfs diskbalancer -cancel hadoop103.plan.json</span><br></pre></td></tr></table></figure>

<h3 id="HDFSâ€”é›†ç¾¤æ‰©å®¹åŠç¼©å®¹"><a href="#HDFSâ€”é›†ç¾¤æ‰©å®¹åŠç¼©å®¹" class="headerlink" title="HDFSâ€”é›†ç¾¤æ‰©å®¹åŠç¼©å®¹"></a>HDFSâ€”é›†ç¾¤æ‰©å®¹åŠç¼©å®¹</h3><h4 id="æ·»åŠ é»‘ç™½åå•"><a href="#æ·»åŠ é»‘ç™½åå•" class="headerlink" title="æ·»åŠ é»‘ç™½åå•"></a>æ·»åŠ é»‘ç™½åå•</h4><blockquote>
<p>ç™½åå•ï¼šè¡¨ç¤ºåœ¨ç™½åå•çš„ä¸»æœº IP åœ°å€å¯ä»¥ç”¨æ¥å­˜å‚¨æ•°æ®ã€‚ </p>
<p>ä¼ä¸šä¸­ï¼šé…ç½®ç™½åå•ï¼Œå¯ä»¥å°½é‡é˜²æ­¢é»‘å®¢æ¶æ„è®¿é—®æ”»å‡»ã€‚</p>
<p>é»‘åå•ï¼šè¡¨ç¤ºåœ¨é»‘åå•çš„ä¸»æœº IP åœ°å€ä¸å¯ä»¥ç”¨æ¥å­˜å‚¨æ•°æ®ã€‚</p>
<p> ä¼ä¸šä¸­ï¼šé…ç½®é»‘åå•ï¼Œç”¨æ¥é€€å½¹æœåŠ¡å™¨ã€‚</p>
<p>é…ç½®æ–‡ä»¶ï¼š hdfs-site.xml</p>
</blockquote>
<ol>
<li><p>åˆ›å»ºé»‘ç™½åå•</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[luo@hadoop102 hadoop]$ vim whitelist</span><br><span class="line">[luo@hadoop102 hadoop]$ vim blicklist</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨ hdfs-site.xml é…ç½®æ–‡ä»¶ä¸­å¢åŠ  dfs.hosts é…ç½®å‚æ•°</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ç™½åå• --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.hosts<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/module/hadoop-3.3.1/etc/hadoop/whitelist<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- é»‘åå• --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.hosts.exclude<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/module/hadoop-3.3.1/etc/hadoop/blacklist<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>åˆ†å‘é…ç½®æ–‡ä»¶ whitelistï¼Œhdfs-site.xm</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[luo@hadoop104 hadoop]$ xsync hdfs-site.xml whitelist</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç¬¬ä¸€æ¬¡æ·»åŠ ç™½åå•å¿…é¡»é‡å¯é›†ç¾¤ï¼Œä¸æ˜¯ç¬¬ä¸€æ¬¡ï¼Œåªéœ€è¦åˆ·æ–° NameNode èŠ‚ç‚¹å³å¯</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[luo@hadoop102 hadoop-3.3.1]$ myhadoop.sh stop</span><br><span class="line">[luo@hadoop102 hadoop-3.3.1]$ myhadoop.sh start</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">åˆ·æ–° NameNodeå‘½ä»¤</span></span><br><span class="line">[luo@hadoop102 hadoop-3.3.1]$ hdfs dfsadmin -refreshNodesRefresh nodes successful</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="æœå½¹æ–°æœåŠ¡å™¨"><a href="#æœå½¹æ–°æœåŠ¡å™¨" class="headerlink" title="æœå½¹æ–°æœåŠ¡å™¨"></a>æœå½¹æ–°æœåŠ¡å™¨</h4><blockquote>
<p>éšç€å…¬å¸ä¸šåŠ¡çš„å¢é•¿ï¼Œæ•°æ®é‡è¶Šæ¥è¶Šå¤§ï¼ŒåŸæœ‰çš„æ•°æ®èŠ‚ç‚¹çš„å®¹é‡å·²ç»ä¸èƒ½æ»¡è¶³å­˜å‚¨æ•°æ® çš„éœ€æ±‚ï¼Œéœ€è¦åœ¨åŸæœ‰é›†ç¾¤åŸºç¡€ä¸ŠåŠ¨æ€æ·»åŠ æ–°çš„æ•°æ®èŠ‚ç‚¹ã€‚</p>
</blockquote>
<ol>
<li><p>é…ç½® hadoop102 å’Œ hadoop103 åˆ° hadoop105 çš„ ssh æ— å¯†ç™»å½•(NameNodeå’ŒYarnæ‰€åœ¨èŠ‚ç‚¹ï¼‰</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">102</span></span><br><span class="line">[luo@hadoop102 .ssh]$ ssh-copy-id hadoop105</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">103</span></span><br><span class="line">[luo@hadoop103 .ssh]$ ssh-copy-id hadoop105</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ·»åŠ workers</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hadoop102</span><br><span class="line">hadoop103</span><br><span class="line">hadoop104</span><br><span class="line">hadoop105</span><br></pre></td></tr></table></figure>
</li>
<li><p>åˆ†å‘ </p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">åªåˆ†å‘é…ç½®æ–‡ä»¶</span></span><br><span class="line">[luo@hadoop102 hadoop]$ xsync hadoop</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç›´æ¥å¯åŠ¨ æ–°èŠ‚ç‚¹ï¼Œå³å¯å…³è”åˆ°é›†ç¾¤</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[luo@hadoop105 hadoop-3.3.1]$ hdfs --daemon start datanode</span><br><span class="line">[luo@hadoop105 hadoop-3.3.1]$ yarn --daemon start nodemanager</span><br></pre></td></tr></table></figure>
</li>
<li><p>åˆ·æ–° NameNode</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[luo@hadoop102 hadoop-3.3.1]$ hdfs dfsadmin -refreshNodesRefresh nodes successful</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="æœåŠ¡å™¨é—´æ•°æ®å‡è¡¡"><a href="#æœåŠ¡å™¨é—´æ•°æ®å‡è¡¡" class="headerlink" title="æœåŠ¡å™¨é—´æ•°æ®å‡è¡¡"></a>æœåŠ¡å™¨é—´æ•°æ®å‡è¡¡</h4><blockquote>
<ol>
<li>åœ¨ä¼ä¸šå¼€å‘ä¸­ï¼Œå¦‚æœç»å¸¸åœ¨ hadoop102 å’Œ hadoop104 ä¸Šæäº¤ä»»åŠ¡ï¼Œä¸”å‰¯æœ¬æ•°ä¸º 2ï¼Œç”±äº æ•°æ®æœ¬åœ°æ€§åŸåˆ™ï¼Œå°±ä¼šå¯¼è‡´ hadoop102 å’Œ hadoop104 æ•°æ®è¿‡å¤šï¼Œhadoop103 å­˜å‚¨çš„æ•°æ®é‡å°ã€‚</li>
<li>å¦ä¸€ç§æƒ…å†µï¼Œå°±æ˜¯æ–°æœå½¹çš„æœåŠ¡å™¨æ•°æ®é‡æ¯”è¾ƒå°‘ï¼Œéœ€è¦æ‰§è¡Œé›†ç¾¤å‡è¡¡å‘½ä»¤ã€‚</li>
<li>&#x3D;&#x3D;æ³¨æ„ï¼šç”±äº HDFS éœ€è¦å¯åŠ¨å•ç‹¬çš„ Rebalance Server æ¥æ‰§è¡Œ Rebalance æ“ä½œï¼Œæ‰€ä»¥å°½é‡ ä¸è¦åœ¨ NameNode ä¸Šæ‰§è¡Œ start-balancer.shï¼Œè€Œæ˜¯æ‰¾ä¸€å°æ¯”è¾ƒç©ºé—²çš„æœºå™¨ã€‚&#x3D;&#x3D;</li>
</ol>
</blockquote>
<ol>
<li><p>å¼€å¯æ•°æ®å‡è¡¡å‘½ä»¤</p>
<blockquote>
<p>å¯¹äºå‚æ•° 10ï¼Œä»£è¡¨çš„æ˜¯é›†ç¾¤ä¸­å„ä¸ªèŠ‚ç‚¹çš„ç£ç›˜ç©ºé—´åˆ©ç”¨ç‡ç›¸å·®ä¸è¶…è¿‡ 10%ï¼Œå¯æ ¹æ®å® é™…æƒ…å†µè¿›è¡Œè°ƒæ•´ã€‚</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[luo@hadoop102 hadoop-3.3.1]$ sbin/start-balancer.sh -threshold 10</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœæ­¢æ•°æ®å‡è¡¡å‘½ä»¤</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[luo@hadoop102 hadoop-3.3.1]$ sbin/stop-balancer.sh</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="é»‘åå•é€€å½¹æœåŠ¡å™¨"><a href="#é»‘åå•é€€å½¹æœåŠ¡å™¨" class="headerlink" title="é»‘åå•é€€å½¹æœåŠ¡å™¨"></a>é»‘åå•é€€å½¹æœåŠ¡å™¨</h4><ol>
<li><p>ç¼–è¾‘&#x2F;opt&#x2F;module&#x2F;hadoop-3.3.1&#x2F;etc&#x2F;hadoop ç›®å½•ä¸‹çš„ blacklist æ–‡ä»¶</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">æ·»åŠ åŠ å…¥é»‘åå•çš„æœåŠ¡å™¨</span></span><br><span class="line">hadoop105</span><br></pre></td></tr></table></figure>
</li>
<li><p>åˆ†å‘é…ç½®æ–‡ä»¶ blacklist</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">xsync hdfs-site.xml </span><br></pre></td></tr></table></figure>
</li>
<li><p>åˆ·æ–° NameNode èŠ‚ç‚¹</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hdfs dfsadmin -refreshNodesRefresh nodes successful</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="HDFSâ€”å­˜å‚¨ä¼˜åŒ–"><a href="#HDFSâ€”å­˜å‚¨ä¼˜åŒ–" class="headerlink" title="HDFSâ€”å­˜å‚¨ä¼˜åŒ–"></a>HDFSâ€”å­˜å‚¨ä¼˜åŒ–</h3><h4 id="çº åˆ ç "><a href="#çº åˆ ç " class="headerlink" title="çº åˆ ç "></a>çº åˆ ç </h4><blockquote>
<p>HDFS é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸€ä¸ªæ–‡ä»¶æœ‰ 3 ä¸ªå‰¯æœ¬ï¼Œè¿™æ ·æé«˜äº†æ•°æ®çš„å¯é æ€§ï¼Œä½†ä¹Ÿå¸¦æ¥äº† 2 å€ çš„å†—ä½™å¼€é”€ã€‚Hadoop3.x å¼•å…¥äº†çº åˆ ç ï¼Œé‡‡ç”¨è®¡ç®—çš„æ–¹å¼ï¼Œå¯ä»¥èŠ‚çœçº¦ 50ï¼…å·¦å³çš„å­˜å‚¨ç©ºé—´ã€‚</p>
</blockquote>
<ol>
<li><p>çº åˆ ç æ“ä½œç›¸å…³çš„å‘½ä»¤</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[luo@hadoop102 hadoop-3.3.1]$ hdfs ec</span><br><span class="line">Usage: bin/hdfs ec [COMMAND]</span><br><span class="line"> [-listPolicies]</span><br><span class="line"> [-addPolicies -policyFile &lt;file&gt;]</span><br><span class="line"> [-getPolicy -path &lt;path&gt;]</span><br><span class="line"> [-removePolicy -policy &lt;policy&gt;]</span><br><span class="line"> [-setPolicy -path &lt;path&gt; [-policy &lt;policy&gt;] [-replicate]]</span><br><span class="line"> [-unsetPolicy -path &lt;path&gt;]</span><br><span class="line"> [-listCodecs]</span><br><span class="line"> [-enablePolicy -policy &lt;policy&gt;]</span><br><span class="line"> [-disablePolicy -policy &lt;policy&gt;]</span><br><span class="line"> [-help &lt;command-name&gt;].</span><br></pre></td></tr></table></figure>
</li>
<li><p>æŸ¥çœ‹å½“å‰æ”¯æŒçš„çº åˆ ç ç­–ç•¥</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[luo@hadoop102 hadoop-3.3.1] hdfs ec -listPolicies</span><br><span class="line">Erasure Coding Policies:</span><br><span class="line">ErasureCodingPolicy=[Name=RS-10-4-1024k, Schema=[ECSchema=[Codec=rs, </span><br><span class="line">numDataUnits=10, numParityUnits=4]], CellSize=1048576, Id=5], </span><br><span class="line">State=DISABLED</span><br><span class="line">ErasureCodingPolicy=[Name=RS-3-2-1024k, Schema=[ECSchema=[Codec=rs, </span><br><span class="line">numDataUnits=3, numParityUnits=2]], CellSize=1048576, Id=2], </span><br><span class="line">State=DISABLED</span><br><span class="line">ErasureCodingPolicy=[Name=RS-6-3-1024k, Schema=[ECSchema=[Codec=rs, </span><br><span class="line">numDataUnits=6, numParityUnits=3]], CellSize=1048576, Id=1], </span><br><span class="line">State=ENABLED</span><br><span class="line">ErasureCodingPolicy=[Name=RS-LEGACY-6-3-1024k, </span><br><span class="line">Schema=[ECSchema=[Codec=rs-legacy, numDataUnits=6, numParityUnits=3]], </span><br><span class="line">CellSize=1048576, Id=3], State=DISABLED</span><br><span class="line">ErasureCodingPolicy=[Name=XOR-2-1-1024k, Schema=[ECSchema=[Codec=xor, </span><br><span class="line">numDataUnits=2, numParityUnits=1]], CellSize=1048576, Id=4], </span><br><span class="line">State=DISABLED</span><br></pre></td></tr></table></figure>
</li>
<li><p>çº åˆ ç ç­–ç•¥è§£é‡Š:</p>
<ol>
<li>RS-3-2-1024kï¼šä½¿ç”¨ RS ç¼–ç ï¼Œæ¯ 3 ä¸ªæ•°æ®å•å…ƒï¼Œç”Ÿæˆ 2 ä¸ªæ ¡éªŒå•å…ƒï¼Œå…± 5 ä¸ªå•å…ƒï¼Œä¹Ÿ å°±æ˜¯è¯´ï¼šè¿™ 5 ä¸ªå•å…ƒä¸­ï¼Œåªè¦æœ‰ä»»æ„çš„ 3 ä¸ªå•å…ƒå­˜åœ¨ï¼ˆä¸ç®¡æ˜¯æ•°æ®å•å…ƒè¿˜æ˜¯æ ¡éªŒå•å…ƒï¼Œåªè¦æ€»æ•°&#x3D;3ï¼‰ï¼Œå°±å¯ä»¥å¾—åˆ°åŸå§‹æ•°æ®ã€‚æ¯ä¸ªå•å…ƒçš„å¤§å°æ˜¯ 1024k&#x3D;1024*1024&#x3D;1048576ã€‚</li>
<li>RS-10-4-1024kï¼šä½¿ç”¨ RS ç¼–ç ï¼Œæ¯ 10 ä¸ªæ•°æ®å•å…ƒï¼ˆcellï¼‰ï¼Œç”Ÿæˆ 4 ä¸ªæ ¡éªŒå•å…ƒï¼Œå…± 14 ä¸ªå•å…ƒï¼Œä¹Ÿå°±æ˜¯è¯´ï¼šè¿™ 14 ä¸ªå•å…ƒä¸­ï¼Œåªè¦æœ‰ä»»æ„çš„ 10 ä¸ªå•å…ƒå­˜åœ¨ï¼ˆä¸ç®¡æ˜¯æ•°æ®å•å…ƒè¿˜æ˜¯æ ¡ éªŒå•å…ƒï¼Œåªè¦æ€»æ•°&#x3D;10ï¼‰ï¼Œå°±å¯ä»¥å¾—åˆ°åŸå§‹æ•°æ®ã€‚æ¯ä¸ªå•å…ƒçš„å¤§å°æ˜¯ 1024k&#x3D;1024*1024&#x3D;1048576ã€‚</li>
<li>RS-6-3-1024kï¼šä½¿ç”¨ RS ç¼–ç ï¼Œæ¯ 6 ä¸ªæ•°æ®å•å…ƒï¼Œç”Ÿæˆ 3 ä¸ªæ ¡éªŒå•å…ƒï¼Œå…± 9 ä¸ªå•å…ƒï¼Œä¹Ÿ å°±æ˜¯è¯´ï¼šè¿™ 9 ä¸ªå•å…ƒä¸­ï¼Œåªè¦æœ‰ä»»æ„çš„ 6 ä¸ªå•å…ƒå­˜åœ¨ï¼ˆä¸ç®¡æ˜¯æ•°æ®å•å…ƒè¿˜æ˜¯æ ¡éªŒå•å…ƒï¼Œåªè¦ æ€»æ•°&#x3D;6ï¼‰ï¼Œå°±å¯ä»¥å¾—åˆ°åŸå§‹æ•°æ®ã€‚æ¯ä¸ªå•å…ƒçš„å¤§å°æ˜¯ 1024k&#x3D;1024*1024&#x3D;1048576ã€‚</li>
<li>RS-LEGACY-6-3-1024kï¼šç­–ç•¥å’Œä¸Šé¢çš„ RS-6-3-1024k ä¸€æ ·ï¼Œåªæ˜¯ç¼–ç çš„ç®—æ³•ç”¨çš„æ˜¯ rs-legacy</li>
<li>XOR-2-1-1024kï¼šä½¿ç”¨ XOR ç¼–ç ï¼ˆé€Ÿåº¦æ¯” RS ç¼–ç å¿«ï¼‰ï¼Œæ¯ 2 ä¸ªæ•°æ®å•å…ƒï¼Œç”Ÿæˆ 1 ä¸ªæ ¡ éªŒå•å…ƒï¼Œå…± 3 ä¸ªå•å…ƒï¼Œä¹Ÿå°±æ˜¯è¯´ï¼šè¿™ 3 ä¸ªå•å…ƒä¸­ï¼Œåªè¦æœ‰ä»»æ„çš„ 2 ä¸ªå•å…ƒå­˜åœ¨ï¼ˆä¸ç®¡æ˜¯æ•°æ® å•å…ƒè¿˜æ˜¯æ ¡éªŒå•å…ƒï¼Œåªè¦æ€»æ•°&#x3D; 2ï¼‰ï¼Œå°±å¯ä»¥å¾—åˆ°åŸå§‹æ•°æ®ã€‚æ¯ä¸ªå•å…ƒçš„å¤§å°æ˜¯ 1024k&#x3D;1024*1024&#x3D;1048576ã€‚</li>
</ol>
</li>
<li><p>å…·ä½“æ­¥éª¤</p>
<ol>
<li><p>å¼€å¯å¯¹ RS-3-2-1024k ç­–ç•¥çš„æ”¯æŒ</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[luo@hadoop102 hadoop-3.3.1]$ hdfs ec -enablePolicy -policy RS-3-2-1024k</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨ HDFS åˆ›å»ºç›®å½•ï¼Œå¹¶è®¾ç½® RS-3-2-1024k ç­–ç•¥</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[luo@hadoop102 hadoop-3.3.1]$ hdfs dfs -mkdir /input</span><br><span class="line">[luo@hadoop202 hadoop-3.3.1]$ hdfs ec -setPolicy -path /input -policy RS-3-2-1024k</span><br></pre></td></tr></table></figure>
</li>
<li><p>å¹¶æŸ¥çœ‹æ–‡ä»¶ç¼–ç åçš„å­˜å‚¨æƒ…å†µ</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[luo@hadoop102 hadoop-3.3.1]$ hdfs dfs -put web.log /input</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
<h4 id="å¼‚æ„å­˜å‚¨ï¼ˆå†·çƒ­æ•°æ®åˆ†ç¦»ï¼‰"><a href="#å¼‚æ„å­˜å‚¨ï¼ˆå†·çƒ­æ•°æ®åˆ†ç¦»ï¼‰" class="headerlink" title="å¼‚æ„å­˜å‚¨ï¼ˆå†·çƒ­æ•°æ®åˆ†ç¦»ï¼‰"></a>å¼‚æ„å­˜å‚¨ï¼ˆå†·çƒ­æ•°æ®åˆ†ç¦»ï¼‰</h4><blockquote>
<p>å¼‚æ„å­˜å‚¨ä¸»è¦è§£å†³ï¼Œä¸åŒçš„æ•°æ®ï¼Œå­˜å‚¨åœ¨ä¸åŒç±»å‹çš„ç¡¬ç›˜ä¸­ï¼Œè¾¾åˆ°æœ€ä½³æ€§èƒ½çš„é—®é¢˜ã€‚</p>
</blockquote>
<h3 id="HDFSâ€”æ•…éšœæ’é™¤"><a href="#HDFSâ€”æ•…éšœæ’é™¤" class="headerlink" title="HDFSâ€”æ•…éšœæ’é™¤"></a>HDFSâ€”æ•…éšœæ’é™¤</h3><h4 id="NameNode-æ•…éšœå¤„ç†"><a href="#NameNode-æ•…éšœå¤„ç†" class="headerlink" title="NameNode æ•…éšœå¤„ç†"></a>NameNode æ•…éšœå¤„ç†</h4><blockquote>
<p>NameNode è¿›ç¨‹æŒ‚äº†å¹¶ä¸”å­˜å‚¨çš„æ•°æ®ä¹Ÿä¸¢å¤±äº†ï¼Œå¦‚ä½•æ¢å¤ NameNode</p>
</blockquote>
<ol>
<li><p>æ‹·è´ SecondaryNameNode ä¸­æ•°æ®åˆ°åŸ NameNode å­˜å‚¨æ•°æ®ç›®å½•</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[atguigu@hadoop102 dfs]$ scp -r atguigu@hadoop104:/opt/module/hadoop-3.1.3/data/dfs/namesecondary/* ./name/</span><br></pre></td></tr></table></figure>
</li>
<li><p>é‡æ–°å¯åŠ¨ NameNode</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[atguigu@hadoop102 hadoop-3.1.3]$ hdfs --daemon start namenode</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="é›†ç¾¤å®‰å…¨æ¨¡å¼-amp-ç£ç›˜ä¿®å¤"><a href="#é›†ç¾¤å®‰å…¨æ¨¡å¼-amp-ç£ç›˜ä¿®å¤" class="headerlink" title="é›†ç¾¤å®‰å…¨æ¨¡å¼&amp;ç£ç›˜ä¿®å¤"></a>é›†ç¾¤å®‰å…¨æ¨¡å¼&amp;ç£ç›˜ä¿®å¤</h4><ol>
<li><p>é€€å‡ºå®‰å…¨æ¨¡å¼æ¡ä»¶</p>
<ul>
<li>dfs.namenode.safemode.min.datanodes:æœ€å°å¯ç”¨ datanode æ•°é‡ï¼Œé»˜è®¤ 0 </li>
<li>dfs.namenode.safemode.threshold-pct:å‰¯æœ¬æ•°è¾¾åˆ°æœ€å°è¦æ±‚çš„ block å ç³»ç»Ÿæ€» block æ•°çš„ ç™¾åˆ†æ¯”ï¼Œé»˜è®¤ 0.999fã€‚ï¼ˆåªå…è®¸ä¸¢ä¸€ä¸ªå—ï¼‰</li>
<li>dfs.namenode.safemode.extension:ç¨³å®šæ—¶é—´ï¼Œé»˜è®¤å€¼ 30000 æ¯«ç§’ï¼Œå³ 30 ç§’</li>
</ul>
</li>
<li><p>åŸºæœ¬è¯­æ³•</p>
<blockquote>
<p>é›†ç¾¤å¤„äºå®‰å…¨æ¨¡å¼ï¼Œä¸èƒ½æ‰§è¡Œé‡è¦æ“ä½œï¼ˆå†™æ“ä½œï¼‰ã€‚é›†ç¾¤å¯åŠ¨å®Œæˆåï¼Œè‡ªåŠ¨é€€å‡ºå®‰å…¨æ¨¡ å¼ã€‚</p>
</blockquote>
<ul>
<li>bin&#x2F;hdfs dfsadmin -safemode get ï¼ˆåŠŸèƒ½æè¿°ï¼šæŸ¥çœ‹å®‰å…¨æ¨¡å¼çŠ¶æ€ï¼‰</li>
<li>bin&#x2F;hdfs dfsadmin -safemode enter ï¼ˆåŠŸèƒ½æè¿°ï¼šè¿›å…¥å®‰å…¨æ¨¡å¼çŠ¶æ€ï¼‰</li>
<li>bin&#x2F;hdfs dfsadmin -safemode leaveï¼ˆåŠŸèƒ½æè¿°ï¼šç¦»å¼€å®‰å…¨æ¨¡å¼çŠ¶æ€ï¼‰</li>
<li>bin&#x2F;hdfs dfsadmin -safemode wait ï¼ˆåŠŸèƒ½æè¿°ï¼šç­‰å¾…å®‰å…¨æ¨¡å¼çŠ¶æ€ï¼‰ï¼šåœ¨ç­‰å¾…å®‰å…¨æ¨¡å¼ä¸‹æäº¤ä»»åŠ¡ï¼Œä»»åŠ¡ä¼šåœ¨é›†ç¾¤ç¦»å¼€å®‰å…¨æ¨¡å¼åè‡ªåŠ¨è¿è¡Œæäº¤çš„ä»»åŠ¡</li>
</ul>
</li>
<li><p>ç£ç›˜ä¿®å¤</p>
<blockquote>
<p>æ–‡ä»¶å—åŠå…¶å‰¯æœ¬å…¨éƒ¨ä¸¢å¤±ï¼Œé›†ç¾¤è¿›å…¥é”æ­»çŠ¶æ€</p>
</blockquote>
<p>ç¦»å¼€å®‰å…¨æ¨¡å¼</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[atguigu@hadoop102 subdir0]$ hdfs dfsadmin -safemode get Safe mode is ON</span><br><span class="line">[atguigu@hadoop102 subdir0]$ hdfs dfsadmin -safemode leave Safe mode is OFF</span><br></pre></td></tr></table></figure>

<p>å°†å…ƒæ•°æ®åˆ é™¤</p>
</li>
</ol>
<h4 id="å°æ–‡ä»¶å½’æ¡£"><a href="#å°æ–‡ä»¶å½’æ¡£" class="headerlink" title="å°æ–‡ä»¶å½’æ¡£"></a>å°æ–‡ä»¶å½’æ¡£</h4><blockquote>
<p>HDFS å­˜æ¡£æ–‡ä»¶æˆ– HAR æ–‡ä»¶ï¼Œæ˜¯ä¸€ä¸ªæ›´é«˜æ•ˆçš„æ–‡ä»¶å­˜æ¡£å·¥å…·ï¼Œå®ƒå°†æ–‡ä»¶å­˜å…¥ HDFS å—ï¼Œ åœ¨å‡å°‘ NameNode å†…å­˜ä½¿ç”¨çš„åŒæ—¶ï¼Œå…è®¸å¯¹æ–‡ä»¶è¿›è¡Œé€æ˜çš„è®¿é—®ã€‚å…·ä½“è¯´æ¥ï¼ŒHDFS å­˜æ¡£æ–‡ ä»¶å¯¹å†…è¿˜æ˜¯ä¸€ä¸ªä¸€ä¸ªç‹¬ç«‹æ–‡ä»¶ï¼Œå¯¹ NameNode è€Œè¨€å´æ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œå‡å°‘äº† NameNode çš„å†… å­˜ã€‚</p>
</blockquote>
<ol>
<li><p>éœ€è¦å¯åŠ¨ YARN è¿›ç¨‹</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[atguigu@hadoop102 hadoop-3.1.3]$ start-yarn.sh</span><br></pre></td></tr></table></figure>
</li>
<li><p>å½’æ¡£æ–‡ä»¶</p>
<blockquote>
<p>æŠŠ&#x2F;input ç›®å½•é‡Œé¢çš„æ‰€æœ‰æ–‡ä»¶å½’æ¡£æˆä¸€ä¸ªå« input.har çš„å½’æ¡£æ–‡ä»¶ï¼Œå¹¶æŠŠå½’æ¡£åæ–‡ä»¶å­˜å‚¨ åˆ°&#x2F;output è·¯å¾„ä¸‹ã€‚</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[atguigu@hadoop102 hadoop-3.1.3]$ hadoop archive -archiveName input.har -p /input /output</span><br></pre></td></tr></table></figure>
</li>
<li><p>æŸ¥çœ‹å½’æ¡£</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[atguigu@hadoop102 hadoop-3.1.3]$ hadoop fs -ls /output/input.har</span><br><span class="line">[atguigu@hadoop102 hadoop-3.1.3]$ hadoop fs -ls har:///output/input.har</span><br></pre></td></tr></table></figure>
</li>
<li><p>è§£å½’æ¡£æ–‡ä»¶</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[atguigu@hadoop102 hadoop-3.1.3]$ hadoop fs -cp har:///output/input.har/* /</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="HDFSâ€”é›†ç¾¤è¿ç§»"><a href="#HDFSâ€”é›†ç¾¤è¿ç§»" class="headerlink" title="HDFSâ€”é›†ç¾¤è¿ç§»"></a>HDFSâ€”é›†ç¾¤è¿ç§»</h3><h4 id="Apache-å’Œ-Apache-é›†ç¾¤é—´æ•°æ®æ‹·è´"><a href="#Apache-å’Œ-Apache-é›†ç¾¤é—´æ•°æ®æ‹·è´" class="headerlink" title="Apache å’Œ Apache é›†ç¾¤é—´æ•°æ®æ‹·è´"></a>Apache å’Œ Apache é›†ç¾¤é—´æ•°æ®æ‹·è´</h4><p>é‡‡ç”¨ distcp å‘½ä»¤å®ç°ä¸¤ä¸ª Hadoop é›†ç¾¤ä¹‹é—´çš„é€’å½’æ•°æ®å¤åˆ¶</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[atguigu@hadoop102 hadoop-3.1.3]$ bin/hadoop distcp hdfs://hadoop102:8020/user/atguigu/hello.txt hdfs://hadoop105:8020/user/atguigu/hello.txt</span><br></pre></td></tr></table></figure>

<h4 id="Apache-å’Œ-CDH-é›†ç¾¤é—´æ•°æ®æ‹·è´"><a href="#Apache-å’Œ-CDH-é›†ç¾¤é—´æ•°æ®æ‹·è´" class="headerlink" title="Apache å’Œ CDH é›†ç¾¤é—´æ•°æ®æ‹·è´"></a>Apache å’Œ CDH é›†ç¾¤é—´æ•°æ®æ‹·è´</h4><blockquote>
<p>ä¸å¸¸è§</p>
</blockquote>
<h3 id="MapReduce-ç”Ÿäº§ç»éªŒ"><a href="#MapReduce-ç”Ÿäº§ç»éªŒ" class="headerlink" title="MapReduce ç”Ÿäº§ç»éªŒ"></a>MapReduce ç”Ÿäº§ç»éªŒ</h3><h4 id="MapReduce-è·‘çš„æ…¢çš„åŸå› "><a href="#MapReduce-è·‘çš„æ…¢çš„åŸå› " class="headerlink" title="MapReduce è·‘çš„æ…¢çš„åŸå› "></a>MapReduce è·‘çš„æ…¢çš„åŸå› </h4><blockquote>
<p>MapReduce ç¨‹åºæ•ˆç‡çš„ç“¶é¢ˆåœ¨äºä¸¤ç‚¹ï¼š</p>
</blockquote>
<ol>
<li><p>è®¡ç®—æœºæ€§èƒ½</p>
<p>CPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œ</p>
</li>
<li><p>I&#x2F;O æ“ä½œä¼˜åŒ–</p>
<ul>
<li>æ•°æ®å€¾æ–œ</li>
<li>Map è¿è¡Œæ—¶é—´å¤ªé•¿ï¼Œå¯¼è‡´ Reduce ç­‰å¾…è¿‡ä¹…</li>
<li>å°æ–‡ä»¶è¿‡å¤š</li>
</ul>
</li>
</ol>
<h4 id="MapReduce-å¸¸ç”¨è°ƒä¼˜å‚æ•°"><a href="#MapReduce-å¸¸ç”¨è°ƒä¼˜å‚æ•°" class="headerlink" title="MapReduce å¸¸ç”¨è°ƒä¼˜å‚æ•°"></a>MapReduce å¸¸ç”¨è°ƒä¼˜å‚æ•°</h4><h5 id="Mapâ€”â€”-gt-Shuffle"><a href="#Mapâ€”â€”-gt-Shuffle" class="headerlink" title="Mapâ€”â€”&gt;Shuffle"></a>Mapâ€”â€”&gt;Shuffle</h5><p><img src="/Hadoop%E6%90%AD%E5%BB%BA%E8%B0%83%E4%BC%98%E7%AC%94%E8%AE%B0/2022-01-24_15-36.png"></p>
<h6 id="è‡ªå®šä¹‰åˆ†åŒºï¼Œå‡å°‘æ•°æ®å€¾æ–œ"><a href="#è‡ªå®šä¹‰åˆ†åŒºï¼Œå‡å°‘æ•°æ®å€¾æ–œ" class="headerlink" title="è‡ªå®šä¹‰åˆ†åŒºï¼Œå‡å°‘æ•°æ®å€¾æ–œ"></a>è‡ªå®šä¹‰åˆ†åŒºï¼Œå‡å°‘æ•°æ®å€¾æ–œ</h6><p>   å®šä¹‰ç±»ï¼Œç»§æ‰¿Partitioneræ¥å£ï¼Œé‡å†™getPartitionæ–¹æ³•</p>
<h6 id="å‡å°‘æº¢å†™çš„æ¬¡æ•°"><a href="#å‡å°‘æº¢å†™çš„æ¬¡æ•°" class="headerlink" title="å‡å°‘æº¢å†™çš„æ¬¡æ•°"></a>å‡å°‘æº¢å†™çš„æ¬¡æ•°</h6><ul>
<li>mapreduce.task.io.sort.mb Shuffleçš„ç¯å½¢ç¼“å†²åŒºå¤§å°ï¼Œé»˜è®¤100mï¼Œå¯ä»¥æé«˜åˆ°200m </li>
<li>mapreduce.map.sort.spill.percent ç¯å½¢ç¼“å†²åŒºæº¢å‡ºçš„é˜ˆå€¼ï¼Œé»˜è®¤80% ï¼Œå¯ä»¥æé«˜çš„90%</li>
</ul>
<h6 id="å¢åŠ æ¯æ¬¡Mergeåˆå¹¶æ¬¡æ•°"><a href="#å¢åŠ æ¯æ¬¡Mergeåˆå¹¶æ¬¡æ•°" class="headerlink" title="å¢åŠ æ¯æ¬¡Mergeåˆå¹¶æ¬¡æ•°"></a>å¢åŠ æ¯æ¬¡Mergeåˆå¹¶æ¬¡æ•°</h6><p>   mapreduce.task.io.sort.factoré»˜è®¤10ï¼Œå¯ä»¥æé«˜åˆ°20</p>
<h6 id="é‡‡ç”¨Combiner"><a href="#é‡‡ç”¨Combiner" class="headerlink" title="é‡‡ç”¨Combiner"></a>é‡‡ç”¨Combiner</h6><blockquote>
<p>åœ¨ä¸å½±å“ä¸šåŠ¡ç»“æœçš„å‰ææ¡ä»¶ä¸‹å¯ä»¥æå‰</p>
</blockquote>
<p>   job.setCombinerClass(xxxReducer.class)</p>
<h6 id="é‡‡ç”¨Snappyæˆ–è€…LZOå‹ç¼©"><a href="#é‡‡ç”¨Snappyæˆ–è€…LZOå‹ç¼©" class="headerlink" title="é‡‡ç”¨Snappyæˆ–è€…LZOå‹ç¼©"></a>é‡‡ç”¨Snappyæˆ–è€…LZOå‹ç¼©</h6><blockquote>
<p>å‡å°‘ç£ç›˜IO</p>
</blockquote>
<ul>
<li>conf.setBoolean(â€œmapreduce.map.output.compressâ€, true); </li>
<li>conf.setClass(â€œmapreduce.map.output.compress.codecâ€,  SnappyCodec.class,CompressionCodec.class);</li>
</ul>
<h6 id="æé«˜MapTaskå†…å­˜ä¸Šé™"><a href="#æé«˜MapTaskå†…å­˜ä¸Šé™" class="headerlink" title="æé«˜MapTaskå†…å­˜ä¸Šé™"></a>æé«˜MapTaskå†…å­˜ä¸Šé™</h6><p>   mapreduce.map.memory.mb é»˜è®¤MapTaskå†…å­˜ä¸Šé™1024MBã€‚ å¯ä»¥æ ¹æ®128mæ•°æ®å¯¹åº”1Gå†…å­˜åŸåˆ™æé«˜è¯¥å†…å­˜ã€‚</p>
<h6 id="æ§åˆ¶MapTaskå †å†…å­˜å¤§å°"><a href="#æ§åˆ¶MapTaskå †å†…å­˜å¤§å°" class="headerlink" title="æ§åˆ¶MapTaskå †å†…å­˜å¤§å°"></a>æ§åˆ¶MapTaskå †å†…å­˜å¤§å°</h6><p>   mapreduce.map.java.optsï¼šæ§åˆ¶MapTaskå †å†…å­˜å¤§å°ã€‚ï¼ˆå¦‚æœå†…å­˜ä¸å¤Ÿï¼Œ æŠ¥ï¼šjava.lang.OutOfMemoryErrorï¼‰</p>
<h6 id="å¢åŠ MapTaskçš„CPUæ ¸æ•°"><a href="#å¢åŠ MapTaskçš„CPUæ ¸æ•°" class="headerlink" title="å¢åŠ MapTaskçš„CPUæ ¸æ•°"></a>å¢åŠ MapTaskçš„CPUæ ¸æ•°</h6><p>   mapreduce.map.cpu.vcores é»˜è®¤MapTaskçš„CPUæ ¸æ•°1ã€‚è®¡ç®—å¯†é›†å‹ä»» åŠ¡å¯ä»¥å¢åŠ CPUæ ¸æ•°</p>
<h6 id="å¼‚å¸¸é‡è¯•"><a href="#å¼‚å¸¸é‡è¯•" class="headerlink" title="å¼‚å¸¸é‡è¯•"></a>å¼‚å¸¸é‡è¯•</h6><p>   mapreduce.map.maxattemptsæ¯ä¸ªMap Taskæœ€å¤§é‡è¯•æ¬¡æ•°ï¼Œä¸€æ—¦é‡è¯• æ¬¡æ•°è¶…è¿‡è¯¥å€¼ï¼Œåˆ™è®¤ä¸ºMap Taskè¿è¡Œå¤±è´¥ï¼Œé»˜è®¤å€¼ï¼š4ã€‚æ ¹æ®æœºå™¨ æ€§èƒ½é€‚å½“æé«˜ã€‚</p>
<h5 id="Shuffleâ€”â€”-gt-Reduce"><a href="#Shuffleâ€”â€”-gt-Reduce" class="headerlink" title="Shuffleâ€”â€”&gt;Reduce"></a>Shuffleâ€”â€”&gt;Reduce</h5><p><img src="/Hadoop%E6%90%AD%E5%BB%BA%E8%B0%83%E4%BC%98%E7%AC%94%E8%AE%B0/2022-01-24_17-26.png"></p>
<ul>
<li>mapreduce.reduce.shuffle.parallelcopiesæ¯ä¸ªReduceå»Map ä¸­æ‹‰å–æ•°æ®çš„å¹¶è¡Œæ•°ï¼Œé»˜è®¤å€¼æ˜¯5ã€‚å¯ä»¥æé«˜åˆ°10ã€‚</li>
<li>mapreduce.reduce.shuffle.input.buffer.percent Bufferå¤§å°å Reduceå¯ç”¨å†…å­˜çš„æ¯”ä¾‹ï¼Œé»˜è®¤å€¼0.7ã€‚å¯ä»¥æé«˜åˆ°0.8</li>
<li>mapreduce.reduce.shuffle.merge.percent Bufferä¸­çš„æ•°æ®è¾¾åˆ°å¤šå°‘æ¯”ä¾‹ å¼€å§‹å†™å…¥ç£ç›˜ï¼Œé»˜è®¤å€¼0.66ã€‚å¯ä»¥æé«˜åˆ°0.75</li>
<li>mapreduce.reduce.memory.mb é»˜è®¤ReduceTaskå†…å­˜ä¸Šé™1024MBï¼Œ æ ¹æ®128mæ•°æ®å¯¹åº”1Gå†…å­˜åŸåˆ™ï¼Œé€‚å½“æé«˜å†…å­˜åˆ°4-6G</li>
<li>mapreduce.reduce.java.optsï¼šæ§åˆ¶ReduceTaskå †å†…å­˜å¤§å°ã€‚ï¼ˆå¦‚æœå†… å­˜ä¸å¤Ÿï¼ŒæŠ¥ï¼šjava.lang.OutOfMemoryErrorï¼‰</li>
<li>mapreduce.reduce.cpu.vcoresé»˜è®¤ReduceTaskçš„CPUæ ¸æ•°1ä¸ªã€‚å¯ ä»¥æé«˜åˆ°2-4ä¸ª</li>
<li>mapreduce.reduce.maxattemptsæ¯ä¸ªReduce Taskæœ€å¤§é‡è¯•æ¬¡æ•°ï¼Œ ä¸€æ—¦é‡è¯•æ¬¡æ•°è¶…è¿‡è¯¥å€¼ï¼Œåˆ™è®¤ä¸ºMap Taskè¿è¡Œå¤±è´¥ï¼Œé»˜è®¤å€¼ï¼š4ã€‚</li>
<li>mapreduce.job.reduce.slowstart.completedmapså½“MapTaskå®Œæˆçš„æ¯” ä¾‹è¾¾åˆ°è¯¥å€¼åæ‰ä¼šä¸ºReduceTaskç”³è¯·èµ„æºã€‚é»˜è®¤æ˜¯0.05ã€‚</li>
<li>mapreduce.task.timeoutå¦‚æœä¸€ä¸ªTaskåœ¨ä¸€å®šæ—¶é—´å†…æ²¡æœ‰ä»»ä½•è¿›å…¥ï¼Œ å³ä¸ä¼šè¯»å–æ–°çš„æ•°æ®ï¼Œä¹Ÿæ²¡æœ‰è¾“å‡ºæ•°æ®ï¼Œåˆ™è®¤ä¸ºè¯¥Taskå¤„äºBlockçŠ¶æ€ï¼Œ å¯èƒ½æ˜¯å¡ä½äº†ï¼Œä¹Ÿè®¸æ°¸è¿œä¼šå¡ä½ï¼Œä¸ºäº†é˜²æ­¢å› ä¸ºç”¨æˆ·ç¨‹åºæ°¸è¿œBlockä½ ä¸é€€å‡ºï¼Œåˆ™å¼ºåˆ¶è®¾ç½®äº†ä¸€ä¸ªè¯¥è¶…æ—¶æ—¶é—´ï¼ˆå•ä½æ¯«ç§’ï¼‰ï¼Œé»˜è®¤æ˜¯600000 ï¼ˆ10åˆ†é’Ÿï¼‰ã€‚å¦‚æœä½ çš„ç¨‹åºå¯¹æ¯æ¡è¾“å…¥æ•°æ®çš„å¤„ç†æ—¶é—´è¿‡é•¿ï¼Œå»ºè®®å°† è¯¥å‚æ•°è°ƒå¤§ã€‚</li>
<li>å¦‚æœå¯ä»¥ä¸ç”¨Reduceï¼Œå°½å¯èƒ½ä¸ç”¨</li>
</ul>
<h4 id="MapReduce-æ•°æ®å€¾æ–œé—®é¢˜"><a href="#MapReduce-æ•°æ®å€¾æ–œé—®é¢˜" class="headerlink" title="MapReduce æ•°æ®å€¾æ–œé—®é¢˜"></a>MapReduce æ•°æ®å€¾æ–œé—®é¢˜</h4><blockquote>
<p>æ•°æ®é¢‘ç‡å€¾æ–œâ€”â€”æŸä¸€ä¸ªåŒºåŸŸçš„æ•°æ®é‡è¦è¿œè¿œå¤§äºå…¶ä»–åŒºåŸŸã€‚</p>
<p> æ•°æ®å¤§å°å€¾æ–œâ€”â€”éƒ¨åˆ†è®°å½•çš„å¤§å°è¿œè¿œå¤§äºå¹³å‡å€¼ã€‚</p>
</blockquote>
<ol>
<li><p>å…ˆæ£€æŸ¥æ˜¯å¦ç©ºå€¼è¿‡å¤šé€ æˆçš„æ•°æ®å€¾æ–œå¯ä»¥ç›´æ¥è¿‡æ»¤æ‰ç©ºå€¼ï¼›å¦‚æœæƒ³ä¿ç•™ç©ºå€¼ï¼Œå°±è‡ªå®šä¹‰åˆ†åŒºï¼Œå°†ç©ºå€¼åŠ éšæœºæ•°æ‰“ æ•£ã€‚æœ€åå†äºŒæ¬¡èšåˆã€‚ </p>
</li>
<li><p>èƒ½åœ¨ map é˜¶æ®µæå‰å¤„ç†ï¼Œæœ€å¥½å…ˆåœ¨ Map é˜¶æ®µå¤„ç†ã€‚å¦‚ï¼šCombinerã€MapJoin </p>
</li>
<li><p>è®¾ç½®å¤šä¸ª reduce ä¸ªæ•°</p>
</li>
</ol>
<h3 id="Hadoop-Yarn-ç”Ÿäº§ç»éªŒ"><a href="#Hadoop-Yarn-ç”Ÿäº§ç»éªŒ" class="headerlink" title="Hadoop-Yarn ç”Ÿäº§ç»éªŒ"></a>Hadoop-Yarn ç”Ÿäº§ç»éªŒ</h3><blockquote>
<p>å‚è€ƒYarnç¬”è®°</p>
</blockquote>
<h2 id="æœ¬æœºHadoopå­¦ä¹ ç¯å¢ƒè°ƒä¼˜"><a href="#æœ¬æœºHadoopå­¦ä¹ ç¯å¢ƒè°ƒä¼˜" class="headerlink" title="æœ¬æœºHadoopå­¦ä¹ ç¯å¢ƒè°ƒä¼˜"></a>æœ¬æœºHadoopå­¦ä¹ ç¯å¢ƒè°ƒä¼˜</h2><blockquote>
<p>è™šæ‹Ÿæœºé…ç½®ï¼š<br>        4Gå†…å­˜<br>        2æ ¸<br>        50Gç£ç›˜</p>
<p>ä½¿ç”¨åœºæ™¯ï¼š<br>        å¤šæ˜¯å¤„ç†å°æ–‡ä»¶</p>
</blockquote>
<h3 id="HDFS-å‚æ•°è°ƒä¼˜"><a href="#HDFS-å‚æ•°è°ƒä¼˜" class="headerlink" title="HDFS å‚æ•°è°ƒä¼˜"></a>HDFS å‚æ•°è°ƒä¼˜</h3><p>ä¿®æ”¹ï¼šhadoop-env.sh</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">export HDFS_NAMENODE_OPTS=&quot;-Dhadoop.security.logger=INFO,RFAS -Xmx1024m&quot;</span><br><span class="line">export HDFS_DATANODE_OPTS=&quot;-Dhadoop.security.logger=ERROR,RFAS -Xmx1024m&quot;</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹ hdfs-site.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- NameNode æœ‰ä¸€ä¸ªå·¥ä½œçº¿ç¨‹æ± ï¼Œé»˜è®¤å€¼æ˜¯ 10 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.handler.count<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>21<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹ core-site.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é…ç½®åƒåœ¾å›æ”¶æ—¶é—´ä¸º 60 åˆ†é’Ÿ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.trash.interval<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>60<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>åˆ†å‘é…ç½®</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">xsync hadoop-env.sh hdfs-site.xml core-site.xml</span><br></pre></td></tr></table></figure>

<h3 id="MapReduce-å‚æ•°è°ƒä¼˜"><a href="#MapReduce-å‚æ•°è°ƒä¼˜" class="headerlink" title="MapReduce å‚æ•°è°ƒä¼˜"></a>MapReduce å‚æ•°è°ƒä¼˜</h3><p>ä¿®æ”¹ mapred-site.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ç¯å½¢ç¼“å†²åŒºå¤§å°ï¼Œé»˜è®¤ 100m --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.task.io.sort.mb<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>100<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- ç¯å½¢ç¼“å†²åŒºæº¢å†™é˜ˆå€¼ï¼Œé»˜è®¤ 0.8 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.map.sort.spill.percent<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>0.80<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- merge åˆå¹¶æ¬¡æ•°ï¼Œé»˜è®¤ 10 ä¸ª --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.task.io.sort.factor<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>10<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- maptask å†…å­˜ï¼Œé»˜è®¤ 1gï¼› maptask å †å†…å­˜å¤§å°é»˜è®¤å’Œè¯¥å€¼å¤§å°ä¸€è‡´</span></span><br><span class="line"><span class="comment">mapreduce.map.java.opts --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.map.memory.mb<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>The amount of memory to request from the scheduler for each map task. If this is not specified or is non-positive, it is inferred from mapreduce.map.java.opts and mapreduce.job.heap.memory-mb.ratio. If java-opts are also not specified, we set it to 1024.</span><br><span class="line">    <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- matask çš„ CPU æ ¸æ•°ï¼Œé»˜è®¤ 1 ä¸ª --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.map.cpu.vcores<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- matask å¼‚å¸¸é‡è¯•æ¬¡æ•°ï¼Œé»˜è®¤ 4 æ¬¡ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.map.maxattempts<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>4<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- æ¯ä¸ª Reduce å» Map ä¸­æ‹‰å–æ•°æ®çš„å¹¶è¡Œæ•°ã€‚é»˜è®¤å€¼æ˜¯ 5 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.reduce.shuffle.parallelcopies<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>5<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Buffer å¤§å°å  Reduce å¯ç”¨å†…å­˜çš„æ¯”ä¾‹ï¼Œé»˜è®¤å€¼ 0.7 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.reduce.shuffle.input.buffer.percent<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>0.70<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Buffer ä¸­çš„æ•°æ®è¾¾åˆ°å¤šå°‘æ¯”ä¾‹å¼€å§‹å†™å…¥ç£ç›˜ï¼Œé»˜è®¤å€¼ 0.66ã€‚ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.reduce.shuffle.merge.percent<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>0.66<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- reducetask å†…å­˜ï¼Œé»˜è®¤ 1gï¼›reducetask å †å†…å­˜å¤§å°é»˜è®¤å’Œè¯¥å€¼å¤§å°ä¸€è‡´</span></span><br><span class="line"><span class="comment">mapreduce.reduce.java.opts --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.reduce.memory.mb<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">description</span>&gt;</span>The amount of memory to request from the scheduler for each reduce task. If this is not specified or is non-positive, it is inferred from mapreduce.reduce.java.opts and mapreduce.job.heap.memory-mb.ratio. If java-opts are also not specified, we set it to 1024.</span><br><span class="line">     <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- reducetask çš„ CPU æ ¸æ•°ï¼Œé»˜è®¤ 1 ä¸ª --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.reduce.cpu.vcores<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- reducetask å¤±è´¥é‡è¯•æ¬¡æ•°ï¼Œé»˜è®¤ 4 æ¬¡ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.reduce.maxattempts<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>4<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- å½“ MapTask å®Œæˆçš„æ¯”ä¾‹è¾¾åˆ°è¯¥å€¼åæ‰ä¼šä¸º ReduceTask ç”³è¯·èµ„æºã€‚é»˜è®¤æ˜¯ 0.05</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.job.reduce.slowstart.completedmaps<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>0.05<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- å¦‚æœç¨‹åºåœ¨è§„å®šçš„é»˜è®¤ 10 åˆ†é’Ÿå†…æ²¡æœ‰è¯»åˆ°æ•°æ®ï¼Œå°†å¼ºåˆ¶è¶…æ—¶é€€å‡º --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.task.timeout<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>600000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="Yarn-å‚æ•°è°ƒä¼˜"><a href="#Yarn-å‚æ•°è°ƒä¼˜" class="headerlink" title="Yarn å‚æ•°è°ƒä¼˜"></a>Yarn å‚æ•°è°ƒä¼˜</h3><p>ä¿®æ”¹ yarn-site.xml </p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é€‰æ‹©è°ƒåº¦å™¨ï¼Œé»˜è®¤å®¹é‡ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>The class to use as the resource scheduler.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.scheduler.class<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>org.apache.hadoop.yarn.server.resourcemanager.scheduler.capacity.CapacityScheduler<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- ResourceManager å¤„ç†è°ƒåº¦å™¨è¯·æ±‚çš„çº¿ç¨‹æ•°é‡,é»˜è®¤ 50ï¼›å¦‚æœæäº¤çš„ä»»åŠ¡æ•°å¤§äº 50ï¼Œå¯ä»¥</span></span><br><span class="line"><span class="comment">å¢åŠ è¯¥å€¼ï¼Œä½†æ˜¯ä¸èƒ½è¶…è¿‡ 3 å° * 2 çº¿ç¨‹ = 6 çº¿ç¨‹ï¼ˆå»é™¤å…¶ä»–åº”ç”¨ç¨‹åºå®é™…ä¸èƒ½è¶…è¿‡ 3ï¼‰ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>Number of threads to handle scheduler interface.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.scheduler.client.thread-count<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>3<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- æ˜¯å¦è®© yarn è‡ªåŠ¨æ£€æµ‹ç¡¬ä»¶è¿›è¡Œé…ç½®ï¼Œé»˜è®¤æ˜¯ falseï¼Œå¦‚æœè¯¥èŠ‚ç‚¹æœ‰å¾ˆå¤šå…¶ä»–åº”ç”¨ç¨‹åºï¼Œå»ºè®®</span></span><br><span class="line"><span class="comment">æ‰‹åŠ¨é…ç½®ã€‚å¦‚æœè¯¥èŠ‚ç‚¹æ²¡æœ‰å…¶ä»–åº”ç”¨ç¨‹åºï¼Œå¯ä»¥é‡‡ç”¨è‡ªåŠ¨ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>Enable auto-detection of node capabilities such as memory and CPU.</span><br><span class="line">    <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.resource.detect-hardware-capabilities<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- æ˜¯å¦å°†è™šæ‹Ÿæ ¸æ•°å½“ä½œ CPU æ ¸æ•°ï¼Œé»˜è®¤æ˜¯ falseï¼Œé‡‡ç”¨ç‰©ç† CPU æ ¸æ•° --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>Flag to determine if logical processors(such as hyperthreads) should be counted as cores. Only applicable on Linux when yarn.nodemanager.resource.cpu-vcores is set to -1 and yarn.nodemanager.resource.detect-hardware-capabilities is true.</span><br><span class="line">    <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.resource.count-logical-processors-ascores<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- è™šæ‹Ÿæ ¸æ•°å’Œç‰©ç†æ ¸æ•°ä¹˜æ•°ï¼Œé»˜è®¤æ˜¯ 1.0 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>Multiplier to determine how to convert phyiscal cores to vcores. This value is used if yarn.nodemanager.resource.cpu-vcores is set to -1(which implies auto-calculate vcores) and yarn.nodemanager.resource.detect-hardware-capabilities is set to true. The number of vcores will be calculated as number of CPUs * multiplier.</span><br><span class="line">    <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.resource.pcores-vcores-multiplier<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>1.0<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- NodeManager ä½¿ç”¨å†…å­˜æ•°ï¼Œé»˜è®¤ 8Gï¼Œä¿®æ”¹ä¸º 4G å†…å­˜ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>Amount of physical memory, in MB, that can be allocated for containers. If set to -1 and yarn.nodemanager.resource.detect-hardware-capabilities is true, it is automatically calculated(in case of Windows and Linux).In other cases, the default is 8192MB.</span><br><span class="line">    <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.resource.memory-mb<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>4096<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- nodemanager çš„ CPU æ ¸æ•°ï¼Œä¸æŒ‰ç…§ç¡¬ä»¶ç¯å¢ƒè‡ªåŠ¨è®¾å®šæ—¶é»˜è®¤æ˜¯ 8 ä¸ªï¼Œä¿®æ”¹ä¸º 2 ä¸ª --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>Number of vcores that can be allocated for containers. This is used by the RM scheduler when allocating resources for containers. This is not used to limit the number of CPUs used by YARN containers. If it is set to -1 and yarn.nodemanager.resource.detect-hardware-capabilities is true, it is automatically determined from the hardware in case of Windows and Linux.In other cases, number of vcores is 8 by default.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.resource.cpu-vcores<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- å®¹å™¨æœ€å°å†…å­˜ï¼Œé»˜è®¤ 1G --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>The minimum allocation for every container request at the RM in MBs. Memory requests lower than this will be set to the value of this property. Additionally, a node manager that is configured to have less memory than this value will be shut down by the resource manager.</span><br><span class="line">    <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.scheduler.minimum-allocation-mb<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>1024<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- å®¹å™¨æœ€å¤§å†…å­˜ï¼Œé»˜è®¤ 8Gï¼Œä¿®æ”¹ä¸º 2G --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>The maximum allocation for every container request at the RM in MBs. Memory requests higher than this will throw an InvalidResourceRequestException.</span><br><span class="line">    <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.scheduler.maximum-allocation-mb<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>2048<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- å®¹å™¨æœ€å° CPU æ ¸æ•°ï¼Œé»˜è®¤ 1 ä¸ª --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>The minimum allocation for every container request at the RM in terms of virtual CPU cores. Requests lower than this will be set to the value of this property. Additionally, a node manager that is configured to have fewer virtual cores than this value will be shut down by the resource manager.</span><br><span class="line">    <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.scheduler.minimum-allocation-vcores<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- å®¹å™¨æœ€å¤§ CPU æ ¸æ•°ï¼Œé»˜è®¤ 4 ä¸ªï¼Œä¿®æ”¹ä¸º 2 ä¸ª --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>The maximum allocation for every container request at the RM in terms of virtual CPU cores. Requests higher than this will throw an InvalidResourceRequestException.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.scheduler.maximum-allocation-vcores<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- è™šæ‹Ÿå†…å­˜æ£€æŸ¥ï¼Œé»˜è®¤æ‰“å¼€ï¼Œä¿®æ”¹ä¸ºå…³é—­ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>Whether virtual memory limits will be enforced for containers.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.vmem-check-enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- è™šæ‹Ÿå†…å­˜å’Œç‰©ç†å†…å­˜è®¾ç½®æ¯”ä¾‹,é»˜è®¤ 2.1 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>Ratio between virtual memory to physical memory when setting memory limits for containers. Container allocations are expressed in terms of physical memory, and virtual memory usage is allowed to exceed this allocation by this ratio.</span><br><span class="line">    <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.vmem-pmem-ratio<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>2.1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>å¤§æ•°æ®</category>
        <category>Hadoop</category>
      </categories>
      <tags>
        <tag>å¤§æ•°æ®</tag>
        <tag>æ­å»ºå¹³å°</tag>
        <tag>åŸºç¡€çŸ¥è¯†</tag>
      </tags>
  </entry>
</search>
